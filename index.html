<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trucking Insurance Quote Form - Internal Use</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header .contact-info {
            font-size: 16px;
            opacity: 0.95;
            margin: 15px 0;
        }
        
        .header .subtitle {
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 20px;
            margin-top: 20px;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 6px;
            position: relative;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .section {
            border-bottom: 1px solid #e9ecef;
        }
        
        .section:last-of-type {
            border-bottom: none;
        }
        
        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-left: 5px solid #3498db;
            font-weight: 600;
            color: #2c3e50;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .section-status {
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 20px;
            background: #e9ecef;
            color: #6c757d;
        }
        
        .section-status.complete {
            background: #d4edda;
            color: #155724;
        }
        
        .section-status.partial {
            background: #fff3cd;
            color: #856404;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        label {
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        input.error, select.error, textarea.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }
        
        input.valid, select.valid, textarea.valid {
            border-color: #27ae60;
            background-color: #f8fff9;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }
        
        .notes {
            font-size: 12px;
            color: #6c757d;
            font-style: italic;
            margin-top: 4px;
        }
        
        .required {
            color: #e74c3c;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .btn-add {
            background: #27ae60;
            color: white;
            margin-top: 20px;
        }
        
        .btn-add:hover {
            background: #219a52;
            transform: translateY(-1px);
        }
        
        .btn-remove {
            background: #e74c3c;
            color: white;
            margin-top: 15px;
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 8px 16px;
            font-size: 12px;
        }
        
        .btn-remove:hover {
            background: #c0392b;
        }
        
        .entry-container {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            background: #fdfdfd;
            position: relative;
        }
        
        .entry-header {
            color: #3498db;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .coverage-grid {
            display: grid;
            gap: 20px;
        }
        
        .coverage-item {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            background: #fdfdfd;
            transition: all 0.2s ease;
        }
        
        .coverage-item.selected {
            border-color: #3498db;
            background: #f8fbff;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.1);
        }
        
        .coverage-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .coverage-header input[type="checkbox"] {
            transform: scale(1.4);
        }
        
        .coverage-title {
            font-weight: 600;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .coverage-details {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .percentage-tracker {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 6px;
            border: 2px solid #e9ecef;
            text-align: center;
            font-weight: 600;
            font-size: 16px;
        }
        
        .percentage-tracker.complete {
            background: #d4edda;
            border-color: #27ae60;
            color: #155724;
        }
        
        .percentage-tracker.over {
            background: #f8d7da;
            border-color: #e74c3c;
            color: #721c24;
        }
        
        .btn-save {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 30px;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        
        .btn-save:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loading-spinner {
            display: none;
            margin-left: 10px;
        }
        
        .validation-summary {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .validation-summary h4 {
            color: #721c24;
            margin-bottom: 10px;
        }
        
        .validation-summary ul {
            margin-left: 20px;
            color: #721c24;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }
        
        .success-message h3 {
            color: #155724;
            margin-bottom: 10px;
        }
        
        .success-message p {
            color: #155724;
            margin: 10px 0;
        }
        
        .quote-summary {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .summary-header {
            color: #2c3e50;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .summary-label {
            font-weight: 600;
            color: #495057;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .summary-value {
            font-size: 16px;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 0;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .section-content {
                padding: 20px;
            }
        }
        
        @media print {
            .btn, button {
                display: none;
            }
            
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Network TruckInsurance Services, Inc.</h1>
            <div class="contact-info">
                <strong>Ed Zahnle - Licensed Agent/Broker</strong><br>
                Phone: (509) 215-3433 | Email: <a href="mailto:ed.zahnle@truckerinsurance.com" style="color: #fff; text-decoration: underline;">ed.zahnle@truckerinsurance.com</a>
            </div>
            <div class="subtitle">
                <h2>Professional Insurance Quote Application</h2>
                <p>Complete Commercial Trucking Insurance Solutions</p>
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Validation Summary -->
        <div class="validation-summary" id="validationSummary">
            <h4>Please Complete Required Fields:</h4>
            <ul id="validationList"></ul>
        </div>
        
        <!-- Success Message -->
        <div class="success-message" id="successMessage">
            <h3>Quote Successfully Submitted!</h3>
            <p>Your quote has been submitted and saved to our system.</p>
            <p>A document request email has been sent to your provided email address.</p>
            <p>Ed Zahnle will contact you within 24 hours to discuss your quote.</p>
        </div>
        
        <form id="quoteForm" onsubmit="return false;" novalidate>
            <!-- Section 1: Business Information -->
            <div class="section">
                <div class="section-header">
                    <span>1. Business Information</span>
                    <span class="section-status" id="section1Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="businessName">Business Name <span class="required">*</span></label>
                            <input type="text" id="businessName" name="businessName" required 
                                   placeholder="Legal name of insured">
                            <div class="error-message">Business name is required</div>
                            <div class="notes">Legal business name as registered</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="dba">DBA (if different)</label>
                            <input type="text" id="dba" name="dba" 
                                   placeholder="Doing Business As name">
                            <div class="notes">Operating name if different from legal name</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="contactName">Contact Name <span class="required">*</span></label>
                            <input type="text" id="contactName" name="contactName" required 
                                   placeholder="Primary contact person">
                            <div class="error-message">Contact name is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number <span class="required">*</span></label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" required 
                                   placeholder="(555) 123-4567">
                            <div class="error-message">Valid phone number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="faxNumber">Fax Number</label>
                            <input type="tel" id="faxNumber" name="faxNumber" 
                                   placeholder="(555) 123-4567">
                        </div>
                        
                        <div class="form-group">
                            <label for="emailAddress">Email Address <span class="required">*</span></label>
                            <input type="email" id="emailAddress" name="emailAddress" required 
                                   placeholder="contact@company.com">
                            <div class="error-message">Valid email address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="businessAddress">Mailing Address <span class="required">*</span></label>
                            <input type="text" id="businessAddress" name="businessAddress" required 
                                   placeholder="Street Address" style="margin-bottom: 10px;">
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                <input type="text" id="businessCity" name="businessCity" required placeholder="City">
                                <input type="text" id="businessState" name="businessState" required placeholder="State">
                                <input type="text" id="businessZip" name="businessZip" required placeholder="ZIP Code">
                            </div>
                            <div class="error-message">Complete mailing address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <div style="margin-bottom: 15px;">
                                <input type="checkbox" id="sameAsBusinessAddress" onchange="toggleGarageAddress()">
                                <label for="sameAsBusinessAddress">Garage address same as mailing address</label>
                            </div>
                            <div id="garageAddressSection">
                                <label for="garageAddress">Garage Address <span class="required">*</span></label>
                                <input type="text" id="garageAddress" name="garageAddress" required 
                                       placeholder="Street Address" style="margin-bottom: 10px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                    <input type="text" id="garageCity" name="garageCity" required placeholder="City">
                                    <input type="text" id="garageState" name="garageState" required placeholder="State">
                                    <input type="text" id="garageZip" name="garageZip" required placeholder="ZIP Code">
                                </div>
                                <div class="error-message">Garage address is required</div>
                                <div class="notes">Where vehicles are parked overnight</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="businessType">Business Type <span class="required">*</span></label>
                            <select id="businessType" name="businessType" required>
                                <option value="">Select business type...</option>
                                <option value="Individual">Individual</option>
                                <option value="Partnership">Partnership</option>
                                <option value="Corporation">Corporation</option>
                                <option value="LLC">LLC</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Business type is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="usdotNumber">USDOT Number <span class="required">*</span></label>
                            <input type="text" id="usdotNumber" name="usdotNumber" required 
                                   placeholder="1234567">
                            <div class="error-message">USDOT number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="mcNumber">MC Number <span class="required">*</span></label>
                            <input type="text" id="mcNumber" name="mcNumber" required 
                                   placeholder="MC-123456">
                            <div class="error-message">MC number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="stateNumber">State Number</label>
                            <input type="text" id="stateNumber" name="stateNumber" 
                                   placeholder="CA-123456, TX-12345, etc.">
                            <div class="notes">State intrastate authority numbers</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="feinNumber">Federal EIN</label>
                            <input type="text" id="feinNumber" name="feinNumber" 
                                   placeholder="12-3456789">
                            <div class="notes">Federal Employer Identification Number</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="agencyNumber">Agency Number <span class="required">*</span></label>
                            <input type="text" id="agencyNumber" name="agencyNumber" required 
                                   placeholder="NTI-2024-001">
                            <div class="error-message">Agency number is required</div>
                            <div class="notes">Internal agency tracking identifier</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="yearsInBusiness">Years in Business <span class="required">*</span></label>
                            <select id="yearsInBusiness" name="yearsInBusiness" required>
                                <option value="">Select years in business...</option>
                                <option value="New Venture">New Venture</option>
                                <option value="<1">Less than 1 year</option>
                                <option value="1-3">1-3 years</option>
                                <option value="4-7">4-7 years</option>
                                <option value="8+">8+ years</option>
                            </select>
                            <div class="error-message">Years in business is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="grossReceipts">Annual Gross Receipts <span class="required">*</span></label>
                            <input type="text" id="grossReceipts" name="grossReceipts" required 
                                   placeholder="$500,000">
                            <div class="error-message">Annual gross receipts required</div>
                            <div class="notes">Current year estimated</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="priorYearReceipts">Prior Year Gross Receipts</label>
                            <input type="text" id="priorYearReceipts" name="priorYearReceipts" 
                                   placeholder="$450,000">
                            <div class="notes">Previous year actual</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="effectiveDate">Desired Effective Date</label>
                            <input type="date" id="effectiveDate" name="effectiveDate">
                            <div class="notes">When you want coverage to start</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="targetPremium">Target Annual Premium</label>
                            <input type="text" id="targetPremium" name="targetPremium" 
                                   placeholder="$8,000">
                            <div class="notes">Your budget goal for annual premium</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 2: Driver Information -->
            <div class="section">
                <div class="section-header">
                    <span>2. Driver Information</span>
                    <span class="section-status" id="section2Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="driversContainer">
                        <!-- Driver entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addDriver()">+ Add Driver</button>
                </div>
            </div>
            
            <!-- Section 3: Vehicle Information -->
            <div class="section">
                <div class="section-header">
                    <span>3. Vehicle & Equipment Details</span>
                    <span class="section-status" id="section3Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="vehiclesContainer">
                        <!-- Vehicle entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addVehicle()">+ Add Vehicle</button>
                </div>
            </div>
            
            <!-- Section 4: Coverage Requirements -->
            <div class="section">
                <div class="section-header">
                    <span>4. Insurance Coverage Requirements</span>
                    <span class="section-status" id="section4Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="coverage-grid">
                        <!-- Primary Liability Coverage -->
                        <div class="coverage-item selected" id="liabilityCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="liability" name="coverage" value="liability" checked onclick="toggleCoverageDetails('liability')">
                                <div class="coverage-title">Auto Liability (Required)</div>
                            </div>
                            <div class="coverage-details" id="liabilityDetails" style="display: grid;">
                                <div class="form-group">
                                    <label for="liabilityLimit">Liability Limit <span class="required">*</span></label>
                                    <select id="liabilityLimit" name="liabilityLimit" required>
                                        <option value="$750,000">$750,000</option>
                                        <option value="$1,000,000" selected>$1,000,000</option>
                                        <option value="$1,500,000">$1,500,000</option>
                                        <option value="$2,000,000">$2,000,000</option>
                                        <option value="$5,000,000">$5,000,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="liabilityDeductible">Liability Deductible</label>
                                    <select id="liabilityDeductible" name="liabilityDeductible">
                                        <option value="$0" selected>$0</option>
                                        <option value="$500">$500</option>
                                        <option value="$1,000">$1,000</option>
                                        <option value="$2,500">$2,500</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Cargo Coverage -->
                        <div class="coverage-item" id="cargoCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="cargo" name="coverage" value="cargo" onclick="toggleCoverageDetails('cargo')">
                                <div class="coverage-title">Cargo Insurance</div>
                            </div>
                            <div class="coverage-details" id="cargoDetails">
                                <div class="form-group">
                                    <label for="cargoLimit">Cargo Limit</label>
                                    <select id="cargoLimit" name="cargoLimit">
                                        <option value="$50,000">$50,000</option>
                                        <option value="$100,000" selected>$100,000</option>
                                        <option value="$150,000">$150,000</option>
                                        <option value="$200,000">$200,000</option>
                                        <option value="$250,000">$250,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="cargoDeductible">Cargo Deductible</label>
                                    <select id="cargoDeductible" name="cargoDeductible">
                                        <option value="$500">$500</option>
                                        <option value="$1,000" selected>$1,000</option>
                                        <option value="$2,500">$2,500</option>
                                        <option value="$5,000">$5,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Physical Damage -->
                        <div class="coverage-item" id="physicalDamageCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="physicalDamage" name="coverage" value="physicalDamage" onclick="toggleCoverageDetails('physicalDamage')">
                                <div class="coverage-title">Physical Damage</div>
                            </div>
                            <div class="coverage-details" id="physicalDamageDetails">
                                <div class="form-group">
                                    <label for="physicalDamageDeductible">Physical Damage Deductible</label>
                                    <select id="physicalDamageDeductible" name="physicalDamageDeductible">
                                        <option value="$1,000" selected>$1,000</option>
                                        <option value="$2,500">$2,500</option>
                                        <option value="$5,000">$5,000</option>
                                        <option value="$10,000">$10,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div style="margin-top: 15px;">
                                        <input type="checkbox" id="comprehensiveCollision" name="comprehensiveCollision">
                                        <label for="comprehensiveCollision">Comprehensive & Collision</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- General Liability -->
                        <div class="coverage-item" id="generalLiabilityCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="generalLiability" name="coverage" value="generalLiability" onclick="toggleCoverageDetails('generalLiability')">
                                <div class="coverage-title">General Liability</div>
                            </div>
                            <div class="coverage-details" id="generalLiabilityDetails">
                                <div class="form-group">
                                    <label for="generalLiabilityLimit">General Liability Limit</label>
                                    <select id="generalLiabilityLimit" name="generalLiabilityLimit">
                                        <option value="$1M/$2M" selected>$1M/$2M</option>
                                        <option value="$2M/$4M">$2M/$4M</option>
                                        <option value="$1M/$3M">$1M/$3M</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="generalLiabilityDeductible">G.L. Deductible</label>
                                    <select id="generalLiabilityDeductible" name="generalLiabilityDeductible">
                                        <option value="$0" selected>$0</option>
                                        <option value="$500">$500</option>
                                        <option value="$1,000">$1,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Trailer Interchange -->
                        <div class="coverage-item" id="trailerInterchangeCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="trailerInterchange" name="coverage" value="trailerInterchange" onclick="toggleCoverageDetails('trailerInterchange')">
                                <div class="coverage-title">Trailer Interchange</div>
                            </div>
                            <div class="coverage-details" id="trailerInterchangeDetails">
                                <div class="form-group">
                                    <label for="trailerInterchangeLimit">Trailer Interchange Limit</label>
                                    <select id="trailerInterchangeLimit" name="trailerInterchangeLimit">
                                        <option value="$25,000">$25,000</option>
                                        <option value="$35,000" selected>$35,000</option>
                                        <option value="$50,000">$50,000</option>
                                        <option value="$75,000">$75,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Coverages -->
                        <div class="coverage-item" id="additionalCoveragesCoverage">
                            <div class="coverage-header">
                                <input type="checkbox" id="additionalCoverages" name="coverage" value="additionalCoverages" onclick="toggleCoverageDetails('additionalCoverages')">
                                <div class="coverage-title">Additional Coverages</div>
                            </div>
                            <div class="coverage-details" id="additionalCoveragesDetails">
                                <div class="form-group">
                                    <div style="margin-bottom: 10px;">
                                        <input type="checkbox" id="uninsuredMotorist" name="uninsuredMotorist">
                                        <label for="uninsuredMotorist">Uninsured Motorist ($100,000)</label>
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <input type="checkbox" id="hiredNonOwned" name="hiredNonOwned">
                                        <label for="hiredNonOwned">Hired & Non-Owned Auto</label>
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <input type="checkbox" id="reeferBreakdown" name="reeferBreakdown">
                                        <label for="reeferBreakdown">Reefer Breakdown Coverage</label>
                                    </div>
                                    <div style="margin-bottom: 10px;">
                                        <input type="checkbox" id="loadingUnloading" name="loadingUnloading">
                                        <label for="loadingUnloading">Loading/Unloading Coverage</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 5: Commodity Information -->
            <div class="section">
                <div class="section-header">
                    <span>5. Commodity & Cargo Information</span>
                    <span class="section-status" id="section5Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid" style="margin-bottom: 20px;">
                        <div class="form-group">
                            <label for="routesOfTravel">Routes of Travel <span class="required">*</span></label>
                            <textarea id="routesOfTravel" name="routesOfTravel" required rows="2" 
                                      placeholder="Major cities and regions served (e.g., Los Angeles, Las Vegas, Phoenix)"></textarea>
                            <div class="error-message">Routes of travel is required</div>
                        </div>
                        
                        <div class="form-group">
                            <div style="margin-bottom: 10px;">
                                <input type="checkbox" id="exclusiveHaul" name="exclusiveHaul" value="yes" onchange="toggleExclusiveHaulDetails()">
                                <label for="exclusiveHaul">Exclusive haul?</label>
                            </div>
                            <div id="exclusiveHaulDetails" style="display: none; margin-top: 10px;">
                                <input type="text" id="exclusiveHaulFor" name="exclusiveHaulFor" placeholder="Company name and years">
                                <div class="notes">If yes, for whom and how many years?</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div style="margin-bottom: 10px;">
                                <input type="checkbox" id="hazmatHaul" name="hazmatHaul" value="yes" onchange="toggleHazmatDetails()">
                                <label for="hazmatHaul">Hauling hazardous materials?</label>
                            </div>
                            <div id="hazmatDetails" style="display: none; margin-top: 10px;">
                                <textarea id="hazmatTypes" name="hazmatTypes" rows="2" placeholder="List hazmat classes and materials"></textarea>
                                <div class="notes">Please specify hazmat classes and materials</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="commoditiesContainer">
                        <!-- Initial commodity entry -->
                        <div class="entry-container" id="commodity1">
                            <div class="entry-header">
                                Commodity Type #1
                                <button type="button" class="btn-remove" onclick="removeCommodity(1)" style="display: none;">Remove</button>
                            </div>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="commodityType1">Freight Type <span class="required">*</span></label>
                                    <select id="commodityType1" name="commodityType1" required onchange="updateCommodityDetails(1)">
                                        <option value="">Select freight type...</option>
                                        <optgroup label="General Freight">
                                            <option value="Dry Van General">Dry Van - General Freight</option>
                                            <option value="Building Materials">Building Materials</option>
                                            <option value="Electronics">Electronics & Technology</option>
                                            <option value="Retail Goods">Retail Goods & Consumer Products</option>
                                            <option value="Automotive Parts">Automotive Parts & Equipment</option>
                                            <option value="Machinery">Machinery & Industrial Equipment</option>
                                        </optgroup>
                                        <optgroup label="Food & Beverage">
                                            <option value="Fresh Produce">Fresh Produce</option>
                                            <option value="Frozen Meat">Frozen Meat & Poultry</option>
                                            <option value="Frozen Foods">Frozen Foods</option>
                                            <option value="Dairy Products">Dairy Products</option>
                                            <option value="Beverages">Beverages</option>
                                            <option value="Dry Food">Dry Food & Packaged Goods</option>
                                        </optgroup>
                                        <optgroup label="Specialized">
                                            <option value="Pharmaceuticals">Pharmaceuticals</option>
                                            <option value="Chemicals">Chemicals (Non-Hazmat)</option>
                                            <option value="Paper Products">Paper Products</option>
                                            <option value="Textiles">Textiles & Clothing</option>
                                            <option value="Furniture">Furniture & Home Goods</option>
                                        </optgroup>
                                        <optgroup label="Construction & Industrial">
                                            <option value="Steel">Steel & Metal Products</option>
                                            <option value="Lumber">Lumber & Wood Products</option>
                                            <option value="Concrete">Concrete & Cement</option>
                                            <option value="Aggregate">Sand, Gravel & Aggregate</option>
                                        </optgroup>
                                        <optgroup label="Energy">
                                            <option value="Petroleum">Petroleum Products</option>
                                            <option value="Oil Field">Oil Field Equipment</option>
                                            <option value="Wind Energy">Wind Energy Equipment</option>
                                        </optgroup>
                                    </select>
                                    <div class="error-message">Please select a freight type</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="commodityPercentage1">Percentage <span class="required">*</span></label>
                                    <select id="commodityPercentage1" name="commodityPercentage1" required onchange="updatePercentageTracker()">
                                        <option value="">Select percentage...</option>
                                        <option value="5">5%</option>
                                        <option value="10">10%</option>
                                        <option value="15">15%</option>
                                        <option value="20">20%</option>
                                        <option value="25">25%</option>
                                        <option value="30">30%</option>
                                        <option value="35">35%</option>
                                        <option value="40">40%</option>
                                        <option value="45">45%</option>
                                        <option value="50">50%</option>
                                        <option value="55">55%</option>
                                        <option value="60">60%</option>
                                        <option value="65">65%</option>
                                        <option value="70">70%</option>
                                        <option value="75">75%</option>
                                        <option value="80">80%</option>
                                        <option value="85">85%</option>
                                        <option value="90">90%</option>
                                        <option value="95">95%</option>
                                        <option value="100">100%</option>
                                    </select>
                                    <div class="error-message">Please select percentage</div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="trailerType1">Trailer Type</label>
                                    <select id="trailerType1" name="trailerType1">
                                        <option value="Dry Van">Dry Van</option>
                                        <option value="Reefer">Refrigerated Trailer</option>
                                        <option value="Flatbed">Flatbed</option>
                                        <option value="Step Deck">Step Deck</option>
                                        <option value="Lowboy">Lowboy</option>
                                        <option value="Tanker">Tanker</option>
                                        <option value="Dump">Dump Trailer</option>
                                        <option value="Auto Hauler">Auto Hauler</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="avgValue1">Average Load Value</label>
                                    <input type="text" id="avgValue1" name="avgValue1" placeholder="$50,000">
                                    <div class="notes">Average value per load</div>
                                </div>
                                
                                <div class="form-group full-width" id="specialRequirements1" style="display: none;">
                                    <label for="specialNotes1">Special Requirements</label>
                                    <textarea id="specialNotes1" name="specialNotes1" rows="2" 
                                              placeholder="Temperature requirements, handling instructions, etc."></textarea>
                                    <div class="notes">Special handling or temperature requirements for this commodity</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                        <button type="button" class="btn btn-add" onclick="addCommodity()">+ Add Another Commodity</button>
                        <div class="percentage-tracker" id="percentageTracker">Total: 0%</div>
                    </div>
                </div>
            </div>
            
            <!-- Section 6: Loss History -->
            <div class="section">
                <div class="section-header">
                    <span>6. Loss History & Claims</span>
                    <span class="section-status" id="section6Status">Complete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="priorCarrier">Current/Prior Insurance Carrier</label>
                            <input type="text" id="priorCarrier" name="priorCarrier" 
                                   placeholder="Insurance company name">
                        </div>
                        
                        <div class="form-group">
                            <label for="policyNumber">Policy Number</label>
                            <input type="text" id="policyNumber" name="policyNumber" 
                                   placeholder="Current policy number">
                        </div>
                        
                        <div class="form-group">
                            <label for="claimsLast5Years">Claims in Last 5 Years</label>
                            <select id="claimsLast5Years" name="claimsLast5Years">
                                <option value="0">No claims</option>
                                <option value="1">1 claim</option>
                                <option value="2">2 claims</option>
                                <option value="3">3 claims</option>
                                <option value="4+">4 or more claims</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="totalPaidOut">Total Paid Out</label>
                            <input type="text" id="totalPaidOut" name="totalPaidOut" 
                                   placeholder="$0">
                            <div class="notes">Total amount paid on all claims</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="claimsDescription">Claims Description (if applicable)</label>
                            <textarea id="claimsDescription" name="claimsDescription" rows="3" 
                                      placeholder="Brief description of any claims with dates..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quote Summary Section -->
            <div class="quote-summary">
                <div class="summary-header">Quote Summary</div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Quote ID (USDOT)</div>
                        <div class="summary-value" id="quoteId">Enter USDOT number</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Date Created</div>
                        <div class="summary-value" id="quoteDate">Loading...</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Business Name</div>
                        <div class="summary-value" id="summaryBusinessName">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Contact</div>
                        <div class="summary-value" id="summaryContactName">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Submission Status</div>
                        <div class="summary-value" id="submissionStatus">Ready to Test</div>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Submit Button -->
        <div style="text-align: center; padding: 30px;">
            <button type="button" class="btn-save" id="submitBtn" onclick="submitQuote()">
                Generate Professional Quote PDF
                <span class="loading-spinner" id="loadingSpinner"></span>
            </button>
        </div>
    </div>
    
    <!-- Load jsPDF from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
    
    <script>
        let commodityCount = 1;
        let driverCount = 0;
        let vehicleCount = 0;
        
        // Your deployed Google Apps Script URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxrcWAKtm8dDicdDNRToxyaR1YKzFHHBan-tJww4fNT9ZkDfHBZEXHdC14CChFMGexY/exec';
        
        function addDriver() {
            driverCount++;
            const container = document.getElementById('driversContainer');
            
            const driverHTML = `
                <div class="entry-container" id="driver${driverCount}">
                    <div class="entry-header">
                        Driver #${driverCount}
                        <button type="button" class="btn-remove" onclick="removeDriver(${driverCount})">Remove</button>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="driverName${driverCount}">Driver Name <span class="required">*</span></label>
                            <input type="text" id="driverName${driverCount}" name="driverName${driverCount}" required 
                                   placeholder="Full legal name">
                            <div class="error-message">Driver name is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverDOB${driverCount}">Date of Birth <span class="required">*</span></label>
                            <input type="date" id="driverDOB${driverCount}" name="driverDOB${driverCount}" required>
                            <div class="error-message">Date of birth is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverLicense${driverCount}">Driver's License # <span class="required">*</span></label>
                            <input type="text" id="driverLicense${driverCount}" name="driverLicense${driverCount}" required 
                                   placeholder="DL123456789">
                            <div class="error-message">Driver's license number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverState${driverCount}">License State <span class="required">*</span></label>
                            <select id="driverState${driverCount}" name="driverState${driverCount}" required>
                                <option value="">Select state...</option>
                                <option value="CA">California</option>
                                <option value="TX">Texas</option>
                                <option value="NV">Nevada</option>
                                <option value="OR">Oregon</option>
                                <option value="WA">Washington</option>
                                <option value="AZ">Arizona</option>
                                <option value="ID">Idaho</option>
                                <option value="UT">Utah</option>
                                <option value="CO">Colorado</option>
                                <option value="Other">Other State</option>
                            </select>
                            <div class="error-message">License state is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverExperience${driverCount}">Years CDL Experience <span class="required">*</span></label>
                            <select id="driverExperience${driverCount}" name="driverExperience${driverCount}" required>
                                <option value="">Select experience...</option>
                                <option value="0-1">0-1 years</option>
                                <option value="2-3">2-3 years</option>
                                <option value="4-5">4-5 years</option>
                                <option value="6-10">6-10 years</option>
                                <option value="11-15">11-15 years</option>
                                <option value="16+">16+ years</option>
                            </select>
                            <div class="error-message">CDL experience is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverHireDate${driverCount}">Date of Hire</label>
                            <input type="date" id="driverHireDate${driverCount}" name="driverHireDate${driverCount}">
                            <div class="notes">When did this driver start with your company?</div>
                        </div>
                        
                        <div class="form-group">
                            <div style="margin-bottom: 10px;">
                                <input type="checkbox" id="driverOwnerOperator${driverCount}" name="driverOwnerOperator${driverCount}">
                                <label for="driverOwnerOperator${driverCount}">Owner Operator</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="driverViolations${driverCount}">Moving Violations (Last 3 Years)</label>
                            <select id="driverViolations${driverCount}" name="driverViolations${driverCount}">
                                <option value="0">No violations</option>
                                <option value="1">1 violation</option>
                                <option value="2">2 violations</option>
                                <option value="3">3 violations</option>
                                <option value="4+">4+ violations</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', driverHTML);
        }
        
        function removeDriver(driverNum) {
            const element = document.getElementById(`driver${driverNum}`);
            if (element) {
                element.remove();
            }
        }
        
        function addVehicle() {
            vehicleCount++;
            const container = document.getElementById('vehiclesContainer');
            
            const vehicleHTML = `
                <div class="entry-container" id="vehicle${vehicleCount}">
                    <div class="entry-header">
                        Vehicle #${vehicleCount}
                        <button type="button" class="btn-remove" onclick="removeVehicle(${vehicleCount})">Remove</button>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="vehicleYear${vehicleCount}">Year <span class="required">*</span></label>
                            <input type="number" id="vehicleYear${vehicleCount}" name="vehicleYear${vehicleCount}" required 
                                   placeholder="2020" min="1990" max="2025">
                            <div class="error-message">Vehicle year is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleMake${vehicleCount}">Make <span class="required">*</span></label>
                            <select id="vehicleMake${vehicleCount}" name="vehicleMake${vehicleCount}" required>
                                <option value="">Select make...</option>
                                <option value="Freightliner">Freightliner</option>
                                <option value="Peterbilt">Peterbilt</option>
                                <option value="Kenworth">Kenworth</option>
                                <option value="Volvo">Volvo</option>
                                <option value="Mack">Mack</option>
                                <option value="International">International</option>
                                <option value="Western Star">Western Star</option>
                                <option value="Ford">Ford</option>
                                <option value="Chevrolet">Chevrolet</option>
                                <option value="GMC">GMC</option>
                                <option value="Ram">Ram</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Vehicle make is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleModel${vehicleCount}">Model</label>
                            <input type="text" id="vehicleModel${vehicleCount}" name="vehicleModel${vehicleCount}" 
                                   placeholder="Cascadia, 389, T680, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleVIN${vehicleCount}">VIN/Serial # <span class="required">*</span></label>
                            <input type="text" id="vehicleVIN${vehicleCount}" name="vehicleVIN${vehicleCount}" required 
                                   placeholder="17-digit VIN number">
                            <div class="error-message">VIN number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleType${vehicleCount}">Vehicle Type <span class="required">*</span></label>
                            <select id="vehicleType${vehicleCount}" name="vehicleType${vehicleCount}" required>
                                <option value="">Select type...</option>
                                <option value="Tractor">Tractor (Power Unit)</option>
                                <option value="Straight Truck">Straight Truck</option>
                                <option value="Semi-Trailer">Semi-Trailer</option>
                                <option value="Full Trailer">Full Trailer</option>
                                <option value="Dump Truck">Dump Truck</option>
                                <option value="Flatbed Truck">Flatbed Truck</option>
                                <option value="Box Truck">Box Truck</option>
                                <option value="Pickup Truck">Pickup Truck</option>
                            </select>
                            <div class="error-message">Vehicle type is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleGVW${vehicleCount}">GVWR/GVW <span class="required">*</span></label>
                            <select id="vehicleGVW${vehicleCount}" name="vehicleGVW${vehicleCount}" required>
                                <option value="">Select weight...</option>
                                <option value="10,001-26,000">10,001-26,000 lbs</option>
                                <option value="26,001-33,000">26,001-33,000 lbs</option>
                                <option value="33,001-60,000">33,001-60,000 lbs</option>
                                <option value="60,001-80,000">60,001-80,000 lbs</option>
                                <option value="80,001+">80,001+ lbs</option>
                            </select>
                            <div class="error-message">Vehicle weight is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleValue${vehicleCount}">Stated Value <span class="required">*</span></label>
                            <input type="text" id="vehicleValue${vehicleCount}" name="vehicleValue${vehicleCount}" required 
                                   placeholder="$150,000">
                            <div class="error-message">Vehicle value is required</div>
                            <div class="notes">Current market/replacement value</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleMiles${vehicleCount}">Annual Miles</label>
                            <select id="vehicleMiles${vehicleCount}" name="vehicleMiles${vehicleCount}">
                                <option value="0-25,000">0-25,000</option>
                                <option value="25,001-50,000">25,001-50,000</option>
                                <option value="50,001-75,000">50,001-75,000</option>
                                <option value="75,001-100,000">75,001-100,000</option>
                                <option value="100,001-125,000">100,001-125,000</option>
                                <option value="125,001+">125,001+</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="vehicleRadius${vehicleCount}">Operating Radius</label>
                            <select id="vehicleRadius${vehicleCount}" name="vehicleRadius${vehicleCount}">
                                <option value="Local (50 miles)">Local (50 miles)</option>
                                <option value="Intermediate (51-200 miles)">Intermediate (51-200 miles)</option>
                                <option value="Long Haul (200+ miles)">Long Haul (200+ miles)</option>
                                <option value="500+ miles">500+ miles</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <div style="margin-bottom: 10px;">
                                <input type="checkbox" id="vehicleOwnerOperator${vehicleCount}" name="vehicleOwnerOperator${vehicleCount}">
                                <label for="vehicleOwnerOperator${vehicleCount}">Owner Operator Vehicle</label>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', vehicleHTML);
        }
        
        function removeVehicle(vehicleNum) {
            const element = document.getElementById(`vehicle${vehicleNum}`);
            if (element) {
                element.remove();
            }
        }
        
        function toggleCoverageDetails(coverageId) {
            const checkbox = document.getElementById(coverageId);
            const details = document.getElementById(coverageId + 'Details');
            const container = document.getElementById(coverageId + 'Coverage');
            
            if (checkbox.checked) {
                details.style.display = 'grid';
                container.classList.add('selected');
            } else {
                details.style.display = 'none';
                container.classList.remove('selected');
            }
        }
        
        function updateCommodityDetails(commodityNum) {
            const commodityType = document.getElementById(`commodityType${commodityNum}`).value;
            const specialRequirements = document.getElementById(`specialRequirements${commodityNum}`);
            const trailerType = document.getElementById(`trailerType${commodityNum}`);
            
            // Show special requirements for temperature-sensitive commodities
            const temperatureSensitive = ['Fresh Produce', 'Frozen Meat', 'Frozen Foods', 'Dairy Products', 'Pharmaceuticals'];
            if (temperatureSensitive.includes(commodityType)) {
                specialRequirements.style.display = 'block';
                trailerType.value = 'Reefer'; // Auto-select refrigerated trailer
            } else {
                specialRequirements.style.display = 'none';
            }
        }
        
        function addCommodity() {
            commodityCount++;
            const container = document.getElementById('commoditiesContainer');
            
            const commodityHTML = `
                <div class="entry-container" id="commodity${commodityCount}">
                    <div class="entry-header">
                        Commodity Type #${commodityCount}
                        <button type="button" class="btn-remove" onclick="removeCommodity(${commodityCount})">Remove</button>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="commodityType${commodityCount}">Freight Type <span class="required">*</span></label>
                            <select id="commodityType${commodityCount}" name="commodityType${commodityCount}" required onchange="updateCommodityDetails(${commodityCount})">
                                <option value="">Select freight type...</option>
                                <optgroup label="General Freight">
                                    <option value="Dry Van General">Dry Van - General Freight</option>
                                    <option value="Building Materials">Building Materials</option>
                                    <option value="Electronics">Electronics & Technology</option>
                                    <option value="Retail Goods">Retail Goods & Consumer Products</option>
                                    <option value="Automotive Parts">Automotive Parts & Equipment</option>
                                    <option value="Machinery">Machinery & Industrial Equipment</option>
                                </optgroup>
                                <optgroup label="Food & Beverage">
                                    <option value="Fresh Produce">Fresh Produce</option>
                                    <option value="Frozen Meat">Frozen Meat & Poultry</option>
                                    <option value="Frozen Foods">Frozen Foods</option>
                                    <option value="Dairy Products">Dairy Products</option>
                                    <option value="Beverages">Beverages</option>
                                    <option value="Dry Food">Dry Food & Packaged Goods</option>
                                </optgroup>
                                <optgroup label="Specialized">
                                    <option value="Pharmaceuticals">Pharmaceuticals</option>
                                    <option value="Chemicals">Chemicals (Non-Hazmat)</option>
                                    <option value="Paper Products">Paper Products</option>
                                    <option value="Textiles">Textiles & Clothing</option>
                                    <option value="Furniture">Furniture & Home Goods</option>
                                </optgroup>
                                <optgroup label="Construction & Industrial">
                                    <option value="Steel">Steel & Metal Products</option>
                                    <option value="Lumber">Lumber & Wood Products</option>
                                    <option value="Concrete">Concrete & Cement</option>
                                    <option value="Aggregate">Sand, Gravel & Aggregate</option>
                                </optgroup>
                                <optgroup label="Energy">
                                    <option value="Petroleum">Petroleum Products</option>
                                    <option value="Oil Field">Oil Field Equipment</option>
                                    <option value="Wind Energy">Wind Energy Equipment</option>
                                </optgroup>
                            </select>
                            <div class="error-message">Please select a freight type</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="commodityPercentage${commodityCount}">Percentage <span class="required">*</span></label>
                            <select id="commodityPercentage${commodityCount}" name="commodityPercentage${commodityCount}" required onchange="updatePercentageTracker()">
                                <option value="">Select percentage...</option>
                                <option value="5">5%</option>
                                <option value="10">10%</option>
                                <option value="15">15%</option>
                                <option value="20">20%</option>
                                <option value="25">25%</option>
                                <option value="30">30%</option>
                                <option value="35">35%</option>
                                <option value="40">40%</option>
                                <option value="45">45%</option>
                                <option value="50">50%</option>
                                <option value="55">55%</option>
                                <option value="60">60%</option>
                                <option value="65">65%</option>
                                <option value="70">70%</option>
                                <option value="75">75%</option>
                                <option value="80">80%</option>
                                <option value="85">85%</option>
                                <option value="90">90%</option>
                                <option value="95">95%</option>
                                <option value="100">100%</option>
                            </select>
                            <div class="error-message">Please select percentage</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="trailerType${commodityCount}">Trailer Type</label>
                            <select id="trailerType${commodityCount}" name="trailerType${commodityCount}">
                                <option value="Dry Van">Dry Van</option>
                                <option value="Reefer">Refrigerated Trailer</option>
                                <option value="Flatbed">Flatbed</option>
                                <option value="Step Deck">Step Deck</option>
                                <option value="Lowboy">Lowboy</option>
                                <option value="Tanker">Tanker</option>
                                <option value="Dump">Dump Trailer</option>
                                <option value="Auto Hauler">Auto Hauler</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="avgValue${commodityCount}">Average Load Value</label>
                            <input type="text" id="avgValue${commodityCount}" name="avgValue${commodityCount}" placeholder="$50,000">
                            <div class="notes">Average value per load</div>
                        </div>
                        
                        <div class="form-group full-width" id="specialRequirements${commodityCount}" style="display: none;">
                            <label for="specialNotes${commodityCount}">Special Requirements</label>
                            <textarea id="specialNotes${commodityCount}" name="specialNotes${commodityCount}" rows="2" 
                                      placeholder="Temperature requirements, handling instructions, etc."></textarea>
                            <div class="notes">Special handling or temperature requirements for this commodity</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', commodityHTML);
            
            // Show remove button on first commodity if there's now more than one
            if (commodityCount > 1) {
                const firstCommodityRemoveBtn = document.querySelector('#commodity1 .btn-remove');
                if (firstCommodityRemoveBtn) {
                    firstCommodityRemoveBtn.style.display = 'block';
                }
            }
        }
        
        function removeCommodity(commodityNum) {
            const element = document.getElementById(`commodity${commodityNum}`);
            if (element) {
                element.remove();
                updatePercentageTracker();
                
                // Hide remove button on first commodity if it's the only one left
                const remainingCommodities = document.querySelectorAll('[id^="commodity"]');
                if (remainingCommodities.length === 1) {
                    const firstCommodityRemoveBtn = document.querySelector('#commodity1 .btn-remove');
                    if (firstCommodityRemoveBtn) {
                        firstCommodityRemoveBtn.style.display = 'none';
                    }
                }
            }
        }
        
        function updatePercentageTracker() {
            let total = 0;
            const percentageSelects = document.querySelectorAll('[id^="commodityPercentage"]');
            
            percentageSelects.forEach(select => {
                if (select.value) {
                    total += parseInt(select.value);
                }
            });
            
            const tracker = document.getElementById('percentageTracker');
            tracker.textContent = `Total: ${total}%`;
            
            // Update styling based on total
            if (total === 100) {
                tracker.className = 'percentage-tracker complete';
            } else if (total > 100) {
                tracker.className = 'percentage-tracker over';
            } else {
                tracker.className = 'percentage-tracker';
            }
        }
        
        function toggleGarageAddress() {
            const checkbox = document.getElementById('sameAsBusinessAddress');
            const garageSection = document.getElementById('garageAddressSection');
            
            if (checkbox.checked) {
                // Copy business address to garage address
                document.getElementById('garageAddress').value = document.getElementById('businessAddress').value;
                document.getElementById('garageCity').value = document.getElementById('businessCity').value;
                document.getElementById('garageState').value = document.getElementById('businessState').value;
                document.getElementById('garageZip').value = document.getElementById('businessZip').value;
                
                // Hide garage address inputs
                garageSection.style.display = 'none';
            } else {
                // Show garage address inputs
                garageSection.style.display = 'block';
            }
        }
        
        function toggleExclusiveHaulDetails() {
            const checkbox = document.getElementById('exclusiveHaul');
            const details = document.getElementById('exclusiveHaulDetails');
            
            if (checkbox.checked) {
                details.style.display = 'block';
            } else {
                details.style.display = 'none';
            }
        }
        
        function toggleHazmatDetails() {
            const checkbox = document.getElementById('hazmatHaul');
            const details = document.getElementById('hazmatDetails');
            
            if (checkbox.checked) {
                details.style.display = 'block';
            } else {
                details.style.display = 'none';
            }
        }
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeQuote();
            setupEventListeners();
            
            // Add initial driver and vehicle entries
            addDriver();
            addVehicle();
        });
        
        function initializeQuote() {
            const today = new Date();
            const dateString = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById('quoteId').textContent = 'Enter USDOT number';
            document.getElementById('quoteDate').textContent = dateString;
        }
        
        function setupEventListeners() {
            // Update summary on changes
            document.getElementById('businessName').addEventListener('input', function() {
                document.getElementById('summaryBusinessName').textContent = this.value || 'Not entered';
            });
            
            document.getElementById('contactName').addEventListener('input', function() {
                document.getElementById('summaryContactName').textContent = this.value || 'Not entered';
            });
            
            document.getElementById('usdotNumber').addEventListener('input', function() {
                updateQuoteId();
            });
        }
        
        function updateQuoteId() {
            const usdotNumber = document.getElementById('usdotNumber').value;
            const quoteId = usdotNumber ? `DOT-${usdotNumber}` : 'Enter USDOT number';
            document.getElementById('quoteId').textContent = quoteId;
            return quoteId;
        }
        
        function collectFormData() {
            const formData = {
                // Basic business info
                businessName: document.getElementById('businessName').value,
                contactName: document.getElementById('contactName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                emailAddress: document.getElementById('emailAddress').value,
                businessAddress: document.getElementById('businessAddress').value,
                businessCity: document.getElementById('businessCity').value,
                businessState: document.getElementById('businessState').value,
                businessZip: document.getElementById('businessZip').value,
                businessType: document.getElementById('businessType').value,
                usdotNumber: document.getElementById('usdotNumber').value,
                mcNumber: document.getElementById('mcNumber').value,
                stateNumber: document.getElementById('stateNumber').value,
                agencyNumber: document.getElementById('agencyNumber').value,
                yearsInBusiness: document.getElementById('yearsInBusiness').value,
                grossReceipts: document.getElementById('grossReceipts').value,
                priorYearReceipts: document.getElementById('priorYearReceipts').value,
                effectiveDate: document.getElementById('effectiveDate').value,
                targetPremium: document.getElementById('targetPremium').value,
                routesOfTravel: document.getElementById('routesOfTravel').value,
                
                // Collect driver data
                drivers: [],
                
                // Collect vehicle data  
                vehicles: [],
                
                // Collect coverage data
                coverages: {
                    liability: document.getElementById('liability').checked,
                    liabilityLimit: document.getElementById('liabilityLimit').value,
                    liabilityDeductible: document.getElementById('liabilityDeductible').value,
                    cargo: document.getElementById('cargo').checked,
                    cargoLimit: document.getElementById('cargoLimit').value,
                    cargoDeductible: document.getElementById('cargoDeductible').value,
                    physicalDamage: document.getElementById('physicalDamage').checked,
                    physicalDamageDeductible: document.getElementById('physicalDamageDeductible').value,
                    generalLiability: document.getElementById('generalLiability').checked,
                    generalLiabilityLimit: document.getElementById('generalLiabilityLimit').value,
                    trailerInterchange: document.getElementById('trailerInterchange').checked,
                    trailerInterchangeLimit: document.getElementById('trailerInterchangeLimit').value,
                    uninsuredMotorist: document.getElementById('uninsuredMotorist').checked,
                    hiredNonOwned: document.getElementById('hiredNonOwned').checked,
                    reeferBreakdown: document.getElementById('reeferBreakdown').checked,
                    loadingUnloading: document.getElementById('loadingUnloading').checked
                },
                
                // Collect commodity data
                commodities: [],
                
                // Meta data
                quoteId: updateQuoteId(),
                submissionDate: new Date().toISOString(),
                timestamp: Date.now()
            };
            
            // Collect driver information
            for (let i = 1; i <= driverCount; i++) {
                const driverElement = document.getElementById(`driver${i}`);
                if (driverElement) {
                    const driver = {
                        name: document.getElementById(`driverName${i}`)?.value || '',
                        dob: document.getElementById(`driverDOB${i}`)?.value || '',
                        license: document.getElementById(`driverLicense${i}`)?.value || '',
                        licenseState: document.getElementById(`driverState${i}`)?.value || '',
                        experience: document.getElementById(`driverExperience${i}`)?.value || '',
                        hireDate: document.getElementById(`driverHireDate${i}`)?.value || '',
                        ownerOperator: document.getElementById(`driverOwnerOperator${i}`)?.checked || false,
                        violations: document.getElementById(`driverViolations${i}`)?.value || '0'
                    };
                    formData.drivers.push(driver);
                }
            }
            
            // Collect vehicle information
            for (let i = 1; i <= vehicleCount; i++) {
                const vehicleElement = document.getElementById(`vehicle${i}`);
                if (vehicleElement) {
                    const vehicle = {
                        year: document.getElementById(`vehicleYear${i}`)?.value || '',
                        make: document.getElementById(`vehicleMake${i}`)?.value || '',
                        model: document.getElementById(`vehicleModel${i}`)?.value || '',
                        vin: document.getElementById(`vehicleVIN${i}`)?.value || '',
                        type: document.getElementById(`vehicleType${i}`)?.value || '',
                        gvw: document.getElementById(`vehicleGVW${i}`)?.value || '',
                        value: document.getElementById(`vehicleValue${i}`)?.value || '',
                        miles: document.getElementById(`vehicleMiles${i}`)?.value || '',
                        radius: document.getElementById(`vehicleRadius${i}`)?.value || '',
                        ownerOperator: document.getElementById(`vehicleOwnerOperator${i}`)?.checked || false
                    };
                    formData.vehicles.push(vehicle);
                }
            }
            
            // Collect commodity information
            for (let i = 1; i <= commodityCount; i++) {
                const commodityElement = document.getElementById(`commodity${i}`);
                if (commodityElement) {
                    const commodity = {
                        type: document.getElementById(`commodityType${i}`)?.value || '',
                        percentage: document.getElementById(`commodityPercentage${i}`)?.value || '',
                        trailerType: document.getElementById(`trailerType${i}`)?.value || '',
                        avgValue: document.getElementById(`avgValue${i}`)?.value || '',
                        specialNotes: document.getElementById(`specialNotes${i}`)?.value || ''
                    };
                    formData.commodities.push(commodity);
                }
            }
            
            return formData;
        }
        
        function validateBasicForm() {
            const requiredFields = [
                'businessName', 'contactName', 'phoneNumber', 'emailAddress',
                'businessAddress', 'businessCity', 'businessState', 'businessZip',
                'businessType', 'usdotNumber', 'mcNumber', 'agencyNumber', 'yearsInBusiness', 'grossReceipts'
            ];
            
            const errors = [];
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field || !field.value.trim()) {
                    errors.push(fieldId);
                }
            });
            
            if (errors.length > 0) {
                const validationSummary = document.getElementById('validationSummary');
                const validationList = document.getElementById('validationList');
                
                validationList.innerHTML = errors.map(error => `<li>${error.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</li>`).join('');
                validationSummary.style.display = 'block';
                validationSummary.scrollIntoView({ behavior: 'smooth', block: 'start' });
                return false;
            }
            
            document.getElementById('validationSummary').style.display = 'none';
            return true;
        }
        
        async function submitQuote() {
            // Basic validation
            if (!validateBasicForm()) {
                return;
            }
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            const spinner = document.getElementById('loadingSpinner');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.disabled = true;
            spinner.style.display = 'inline';
            submitBtn.innerHTML = 'Processing Quote... <span class="loading-spinner"></span>';
            
            try {
                // Collect form data
                const formData = collectFormData();
                
                // Submit to Google Sheets
                await submitToGoogleSheets(formData);
                
                // Send document request email
                await sendDocumentRequestEmail(formData);
                
                // Generate PDF
                generateSimplePDF(formData);
                
                // Show success message
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Update submission status
                document.getElementById('submissionStatus').textContent = 'Successfully Submitted';
                
            } catch (error) {
                console.error('Submission error:', error);
                alert('There was an issue submitting your quote. Your data may have been saved to our system. Ed Zahnle will contact you at the provided phone number.');
                
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                spinner.style.display = 'none';
                submitBtn.innerHTML = originalText;
            }
        }
        
        async function submitToGoogleSheets(formData) {
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                    mode: 'no-cors'
                });
                
                return true; // Assume success since we can't read the response in no-cors mode
                
            } catch (error) {
                // Don't throw error - the data was likely sent successfully
                return true;
            }
        }
        
        async function sendDocumentRequestEmail(formData) {
            try {
                const emailData = {
                    action: 'sendDocumentRequest',
                    from: 'ed.zahnle@truckerinsurance.com',
                    to: formData.emailAddress,
                    cc: 'ed.zahnle@truckerinsurance.com',
                    subject: `Document Request - Commercial Trucking Insurance Quote ${formData.quoteId}`,
                    html: generateEmailHTML(formData)
                };
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(emailData),
                    mode: 'no-cors'
                });
                
                return true; // Assume success
                
            } catch (error) {
                // Don't throw error - email may have been sent
                return true;
            }
        }
        
        function generateEmailHTML(formData) {
            return `
                <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                    <div style="background: linear-gradient(135deg, #2c3e50, #3498db); color: white; padding: 20px; text-align: center;">
                        <h2>Network TruckInsurance Services, Inc.</h2>
                        <p>Ed Zahnle - Licensed Agent/Broker<br>
                        Phone: (509) 215-3433 | Email: ed.zahnle@truckerinsurance.com</p>
                    </div>
                    
                    <div style="padding: 30px; background: white;">
                        <p>Dear ${formData.contactName},</p>
                        
                        <p>Thank you for submitting your commercial trucking insurance quote request. I have received your application and am excited to help you secure competitive coverage for <strong>${formData.businessName}</strong>.</p>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-left: 4px solid #3498db; margin: 20px 0;">
                            <h3 style="color: #2c3e50; margin-top: 0;">Quote Summary:</h3>
                            <ul style="margin: 10px 0;">
                                <li><strong>Quote ID:</strong> ${formData.quoteId}</li>
                                <li><strong>Agency Number:</strong> ${formData.agencyNumber}</li>
                                <li><strong>Business:</strong> ${formData.businessName}</li>
                                <li><strong>USDOT:</strong> ${formData.usdotNumber}</li>
                                <li><strong>MC Number:</strong> ${formData.mcNumber}</li>
                                <li><strong>Contact:</strong> ${formData.contactName}</li>
                                <li><strong>Phone:</strong> ${formData.phoneNumber}</li>
                            </ul>
                        </div>
                        
                        <p>To complete your quote package and provide you with accurate pricing from our top-rated carriers (Progressive, Sentry, BHHC), I will need the following documents:</p>
                        
                        <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0;">
                            <h3 style="color: #856404; margin-top: 0;"> Required Documents:</h3>
                            <ol style="color: #856404;">
                                <li><strong>Loss Runs from your current/prior insurance carrier</strong> (last 5 years)
                                    <br><small> This shows your claims history and is required by all underwriters</small>
                                </li>
                                <li><strong>IFTA Reports</strong> (last 4 quarters)
                                    <br><small> Interstate Fuel Tax Agreement reports showing mileage by state</small>
                                </li>
                                <li><strong>Motor Vehicle Records (MVRs)</strong> - <em>We will handle ordering these directly</em>
                                    <br><small> No action needed from you on MVRs</small>
                                </li>
                            </ol>
                        </div>
                        
                        <div style="background: #d4edda; padding: 20px; border-radius: 8px; margin: 20px 0;">
                            <h3 style="color: #155724; margin-top: 0;"> Need Help Getting Loss Runs?</h3>
                            <p style="color: #155724; margin-bottom: 0;">Many carriers require written authorization to release loss runs to agents. <strong>I can create the official request documents for you and send them via Adobe Sign for electronic signature.</strong> This makes the process quick and ensures your current carrier has everything they need to release your loss run history.</p>
                            
                            <p style="color: #155724; margin-bottom: 0;"><strong>Just reply to this email and let me know if you'd like me to prepare the loss run request documents for Adobe Sign!</strong></p>
                        </div>
                        
                        <h3 style="color: #2c3e50;">Next Steps:</h3>
                        <ol>
                            <li>Reply to this email with your IFTA reports (PDF format preferred)</li>
                            <li>Contact your current insurance carrier to request loss runs, or let me help with Adobe Sign requests</li>
                            <li>I'll order MVRs for all drivers once we receive the above documents</li>
                            <li>Within 24-48 hours of receiving all documents, I'll present you with competitive quotes from multiple carriers</li>
                        </ol>
                        
                        <div style="background: #e9ecef; padding: 15px; border-radius: 8px; margin: 20px 0;">
                            <p style="margin: 0; font-size: 14px;"><strong>Questions?</strong> Don't hesitate to call me directly at (509) 215-3433. I'm here to make this process as smooth as possible and ensure you get the best coverage at competitive rates.</p>
                        </div>
                        
                        <p>Thank you for choosing Network TruckInsurance Services. I look forward to working with you!</p>
                        
                        <p>Best regards,<br>
                        <strong>Ed Zahnle</strong><br>
                        Licensed Insurance Agent/Broker<br>
                        Network TruckInsurance Services, Inc.<br>
                        Direct: (509) 215-3433<br>
                        Email: ed.zahnle@truckerinsurance.com</p>
                    </div>
                    
                    <div style="background: #2c3e50; color: white; padding: 15px; text-align: center; font-size: 12px;">
                        <p style="margin: 0;">This email was sent regarding your commercial trucking insurance quote request ${formData.quoteId}.<br>
                        Network TruckInsurance Services, Inc. | Licensed Agent Ed Zahnle</p>
                    </div>
                </div>
            `;
        }
        
        function generateSimplePDF(formData) {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                let yPosition = 15;
                const today = new Date().toLocaleDateString('en-US');
                
                // Header with border boxes
                doc.setLineWidth(0.5);
                
                // Main title box (left side)
                doc.rect(15, 10, 120, 25);
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('TRUCKERS QUOTE SHEET', 75, yPosition + 10, { align: 'center' });
                
                // Company info box (right side)
                doc.rect(135, 10, 60, 25);
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text('Network Truck', 137, yPosition + 5);
                doc.text('Insurance Services, Inc.', 137, yPosition + 9);
                doc.setFont(undefined, 'normal');
                doc.text('PH (509) 215-3433', 137, yPosition + 13);
                doc.text('FAX Available upon request', 137, yPosition + 17);
                
                // Agent info section (left side of header box)
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text(`AGENT: Ed Zahnle`, 17, yPosition + 5);
                doc.text(`CLIENT# ${formData.usdotNumber || formData.agencyNumber || 'Pending'}`, 17, yPosition + 9);
                doc.text(`Lic# OD48006`, 17, yPosition + 17);
                
                yPosition = 40;
                
                // Date and target price section
                doc.setFontSize(9);
                doc.text(`Today's Date`, 15, yPosition);
                doc.rect(45, yPosition - 4, 35, 8);
                doc.text(today, 47, yPosition);
                
                doc.text(`Effective Date`, 85, yPosition);
                doc.rect(115, yPosition - 4, 35, 8);
                doc.text('TBD', 117, yPosition);
                
                doc.text(`TARGET PRICE`, 155, yPosition);
                doc.rect(180, yPosition - 4, 15, 8);
                
                yPosition += 12;
                
                // Business information section
                doc.text(`Legal Name`, 15, yPosition);
                doc.text(`${formData.businessName || ''}`, 55, yPosition);
                doc.text(`Telephone#`, 120, yPosition);
                doc.text(`${formData.phoneNumber || ''}`, 145, yPosition);
                
                yPosition += 6;
                doc.text(`DBA:`, 15, yPosition);
                doc.text(`${document.getElementById('dba')?.value || ''}`, 55, yPosition);
                doc.text(`Fax#`, 120, yPosition);
                doc.text(`${document.getElementById('faxNumber')?.value || ''}`, 145, yPosition);
                
                yPosition += 6;
                doc.text(`Mailing Address`, 15, yPosition);
                doc.text(`${formData.businessAddress || ''}`, 55, yPosition);
                doc.text(`Pgr/Mob#`, 120, yPosition);
                
                yPosition += 6;
                doc.text(`${formData.businessCity || ''} ${formData.businessState || ''} ${formData.businessZip || ''}`, 55, yPosition);
                
                // Business type checkboxes - clean format
                const businessType = formData.businessType || '';
                doc.text(`${businessType === 'Individual' ? '' : ''} Individual`, 120, yPosition);
                doc.text(`${businessType === 'Partnership' ? '' : ''} Partnership`, 150, yPosition);
                doc.text(`${businessType === 'Corporation' || businessType === 'LLC' ? '' : ''} Corp/LLC`, 175, yPosition);
                
                yPosition += 8;
                
                // Garaging address
                doc.text(`Garaging Address`, 15, yPosition);
                const sameAsBusinessChecked = document.getElementById('sameAsBusinessAddress')?.checked || false;
                doc.text(`${sameAsBusinessChecked ? 'Same as above' : 'Different address'}`, 55, yPosition);
                doc.text(`State#`, 120, yPosition);
                doc.text(`${document.getElementById('stateNumber')?.value || 'N/A'}`, 135, yPosition);
                doc.text(`MC#`, 150, yPosition);
                doc.text(`${formData.mcNumber || 'Pending'}`, 160, yPosition);
                
                yPosition += 6;
                doc.text(`Other filings?`, 120, yPosition);
                doc.text(`USDOT: ${formData.usdotNumber || 'Pending'}`, 150, yPosition);
                
                yPosition += 8;
                
                // Years in business and venture info
                doc.text(`Years in Business`, 15, yPosition);
                doc.text(`${formData.yearsInBusiness || ''}`, 55, yPosition);
                doc.text(`New Venture?`, 90, yPosition);
                const isNewVenture = formData.yearsInBusiness === 'New Venture' || formData.yearsInBusiness === '<1';
                doc.text(`${isNewVenture ? '' : ''} Yes ${isNewVenture ? '' : ''} No`, 115, yPosition);
                doc.text(`If yes, previous employer`, 145, yPosition);
                
                yPosition += 6;
                const exclusiveHaul = document.getElementById('exclusiveHaul')?.checked || false;
                doc.text(`Exclusive haul?`, 15, yPosition);
                doc.text(`${exclusiveHaul ? '' : ''} Yes ${exclusiveHaul ? '' : ''} No`, 55, yPosition);
                doc.text(`If yes, how many years & for whom?`, 85, yPosition);
                
                yPosition += 6;
                doc.text(`Commodity Hauled (percentage)`, 15, yPosition);
                let commodityText = '';
                if (formData.commodities && formData.commodities.length > 0) {
                    commodityText = formData.commodities.map(c => `${c.type} ${c.percentage}%`).join(', ');
                } else {
                    commodityText = 'Dry Freight 100%';
                }
                doc.text(commodityText, 75, yPosition);
                
                yPosition += 6;
                const hazmatHaul = document.getElementById('hazmatHaul')?.checked || false;
                doc.text(`Hauling hazardous materials or placarded loads?`, 15, yPosition);
                doc.text(`${hazmatHaul ? '' : ''} Yes ${hazmatHaul ? '' : ''} No`, 95, yPosition);
                doc.text(`If yes, please list`, 125, yPosition);
                
                yPosition += 6;
                doc.text(`Routes of Travel (major cities)`, 15, yPosition);
                doc.text(`${formData.routesOfTravel || 'Western United States'}`, 75, yPosition);
                
                yPosition += 8;
                
                // Financial information
                doc.text(`Gross Receipts: Current Year Est.`, 15, yPosition);
                doc.text(`${formData.grossReceipts || ''}`, 75, yPosition);
                doc.text(`Prior Year`, 120, yPosition);
                doc.text(`${formData.priorYearReceipts || ''}`, 140, yPosition);
                
                yPosition += 6;
                doc.text(`Subhaul Exposure?`, 15, yPosition);
                doc.text(` Yes  No`, 55, yPosition);
                doc.text(`If yes, what is cost of hire`, 85, yPosition);
                
                yPosition += 10;
                
                // Coverages section with border
                doc.setFont(undefined, 'bold');
                doc.text('Coverages:', 15, yPosition);
                doc.setFont(undefined, 'normal');
                yPosition += 8;
                
                doc.rect(15, yPosition - 5, 180, 35);
                
                // Coverage details in table format using actual form data
                doc.text(`Liability Limit`, 17, yPosition);
                doc.text(`${formData.coverages?.liabilityLimit || '$1,000,000'}`, 50, yPosition);
                doc.text(`Liability Ded.`, 85, yPosition);
                doc.text(`${formData.coverages?.liabilityDeductible || '$0'}`, 115, yPosition);
                doc.text(`Hired/NOA?`, 130, yPosition);
                const hiredNonOwned = formData.coverages?.hiredNonOwned || false;
                doc.text(`${hiredNonOwned ? '' : ''} Yes ${hiredNonOwned ? '' : ''} No`, 145, yPosition);
                
                yPosition += 6;
                doc.text(`UM`, 17, yPosition);
                const uninsuredMotorist = formData.coverages?.uninsuredMotorist || false;
                doc.text(`${uninsuredMotorist ? '$100,000' : 'Declined'}`, 50, yPosition);
                doc.text(`Physical Damage Ded.`, 85, yPosition);
                doc.text(`${formData.coverages?.physicalDamage ? formData.coverages?.physicalDamageDeductible || '$1,000' : 'N/A'}`, 120, yPosition);
                doc.text(`(if any basis)`, 145, yPosition);
                
                yPosition += 6;
                doc.text(`Cargo Limit`, 17, yPosition);
                doc.text(`${formData.coverages?.cargo ? formData.coverages?.cargoLimit || '$100,000' : 'Declined'}`, 50, yPosition);
                doc.text(`Cargo Ded.`, 85, yPosition);
                doc.text(`${formData.coverages?.cargo ? formData.coverages?.cargoDeductible || '$1,000' : 'N/A'}`, 120, yPosition);
                doc.text(`Reefer Breakdown?`, 145, yPosition);
                const reeferBreakdown = formData.coverages?.reeferBreakdown || false;
                doc.text(`${reeferBreakdown ? '' : ''} Yes ${reeferBreakdown ? '' : ''} No`, 175, yPosition);
                
                yPosition += 6;
                doc.text(`Average Cargo Limit`, 17, yPosition);
                doc.text(`${formData.coverages?.cargo ? formData.coverages?.cargoLimit || '$100,000' : 'N/A'}`, 50, yPosition);
                doc.text(`Loading/Unloading?`, 145, yPosition);
                const loadingUnloading = formData.coverages?.loadingUnloading || false;
                doc.text(`${loadingUnloading ? '' : ''} Yes ${loadingUnloading ? '' : ''} No`, 175, yPosition);
                
                yPosition += 6;
                doc.text(`General Liability`, 17, yPosition);
                doc.text(`${formData.coverages?.generalLiability ? formData.coverages?.generalLiabilityLimit || '1M/2M' : 'Declined'}`, 50, yPosition);
                doc.text(`G.L. Ded.`, 85, yPosition);
                
                yPosition += 6;
                doc.text(`Other Coverages?`, 17, yPosition);
                doc.text(`${formData.coverages?.trailerInterchange ? `Trailer Interchange ${formData.coverages?.trailerInterchangeLimit || '$35,000'}` : 'None'}`, 50, yPosition);
                
                yPosition += 10;
                
                // Previous Carriers & Loss History section
                doc.setFont(undefined, 'bold');
                doc.text('Previous Carriers & Loss History:', 15, yPosition);
                doc.setFont(undefined, 'normal');
                yPosition += 8;
                
                // Table headers
                doc.rect(15, yPosition - 3, 180, 8);
                doc.setFontSize(8);
                doc.text('Year', 17, yPosition);
                doc.text('Company', 35, yPosition);
                doc.text('Policy #', 75, yPosition);
                doc.text('# of claims', 105, yPosition);
                doc.text('Type', 135, yPosition);
                doc.text('$ Paid Out', 165, yPosition);
                
                yPosition += 8;
                
                // Sample data rows
                doc.rect(15, yPosition - 3, 180, 6);
                doc.text('24-25', 17, yPosition);
                doc.text('Current Carrier TBD', 35, yPosition);
                doc.text('TBD', 75, yPosition);
                doc.text('0', 105, yPosition);
                doc.text('Auto Lib', 135, yPosition);
                doc.text('$0', 165, yPosition);
                
                yPosition += 6;
                doc.rect(15, yPosition - 3, 180, 6);
                doc.text('23-24', 17, yPosition);
                
                yPosition += 12;
                
                // Vehicles section
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Vehicles:', 15, yPosition);
                doc.setFont(undefined, 'normal');
                yPosition += 8;
                
                // Vehicle table headers
                doc.rect(15, yPosition - 3, 180, 8);
                doc.setFontSize(7);
                doc.text('#', 17, yPosition);
                doc.text('Year', 25, yPosition);
                doc.text('Make', 40, yPosition);
                doc.text('Body Type', 60, yPosition);
                doc.text('GVW', 80, yPosition);
                doc.text('Serial #', 100, yPosition);
                doc.text('Ann. Miles', 140, yPosition);
                doc.text('Radius', 160, yPosition);
                doc.text('Value', 180, yPosition);
                
                yPosition += 8;
                
                // Display actual vehicle data or default
                if (formData.vehicles && formData.vehicles.length > 0) {
                    formData.vehicles.forEach((vehicle, index) => {
                        doc.rect(15, yPosition - 3, 180, 6);
                        doc.text(`${index + 1}`, 17, yPosition);
                        doc.text(vehicle.year || 'TBD', 25, yPosition);
                        doc.text(vehicle.make || 'TBD', 40, yPosition);
                        doc.text(vehicle.type ? vehicle.type.substring(0, 10) : 'TT', 60, yPosition);
                        doc.text(vehicle.gvw ? vehicle.gvw.substring(0, 8) : '80,000', 80, yPosition);
                        doc.text(vehicle.vin ? vehicle.vin.substring(0, 8) : 'TBD', 100, yPosition);
                        doc.text(vehicle.miles || '100,000', 140, yPosition);
                        doc.text(vehicle.radius ? vehicle.radius.substring(0, 6) : '500+', 160, yPosition);
                        doc.text(vehicle.value || 'TBD', 180, yPosition);
                        yPosition += 6;
                    });
                } else {
                    // Default vehicle row
                    doc.rect(15, yPosition - 3, 180, 6);
                    doc.text('1', 17, yPosition);
                    doc.text('TBD', 25, yPosition);
                    doc.text('TBD', 40, yPosition);
                    doc.text('TT', 60, yPosition);
                    doc.text('80,000', 80, yPosition);
                    doc.text('TBD', 100, yPosition);
                    doc.text('100,000', 140, yPosition);
                    doc.text('500+', 160, yPosition);
                    doc.text('TBD', 180, yPosition);
                    yPosition += 6;
                }
                
                yPosition += 6;
                
                // Drivers section
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Drivers:', 15, yPosition);
                doc.setFont(undefined, 'normal');
                yPosition += 8;
                
                // Driver table headers
                doc.rect(15, yPosition - 3, 180, 8);
                doc.setFontSize(7);
                doc.text('Name', 17, yPosition);
                doc.text('DL#', 60, yPosition);
                doc.text('DOB', 90, yPosition);
                doc.text('Yrs Exp', 110, yPosition);
                doc.text('DOH', 130, yPosition);
                doc.text('SS#', 150, yPosition);
                doc.text('Tick/Acc', 170, yPosition);
                
                yPosition += 8;
                
                // Display actual driver data or default
                if (formData.drivers && formData.drivers.length > 0) {
                    formData.drivers.forEach((driver, index) => {
                        doc.rect(15, yPosition - 3, 180, 6);
                        doc.text(driver.name || 'TBD', 17, yPosition);
                        doc.text(driver.license || 'TBD', 60, yPosition);
                        doc.text(driver.dob || 'TBD', 90, yPosition);
                        doc.text(driver.experience || 'TBD', 110, yPosition);
                        doc.text(driver.hireDate || 'TBD', 130, yPosition);
                        doc.text('TBD', 150, yPosition);
                        doc.text(driver.violations + '/0' || '0/0', 170, yPosition);
                        yPosition += 6;
                    });
                } else {
                    // Default driver row using contact name
                    doc.rect(15, yPosition - 3, 180, 6);
                    doc.text(`${formData.contactName || 'TBD'}`, 17, yPosition);
                    doc.text('TBD', 60, yPosition);
                    doc.text('TBD', 90, yPosition);
                    doc.text('TBD', 110, yPosition);
                    doc.text('TBD', 130, yPosition);
                    doc.text('TBD', 150, yPosition);
                    doc.text('0/0', 170, yPosition);
                    yPosition += 6;
                }
                
                yPosition += 6;
                
                // Claims description
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Describe any accidents/claims in the last 3 years', 15, yPosition);
                doc.setFont(undefined, 'normal');
                yPosition += 6;
                doc.line(15, yPosition, 195, yPosition);
                
                // Save with business name as filename
                const businessName = formData.businessName || 'New_Business';
                const safeName = businessName.replace(/[^a-zA-Z0-9]/g, '_'); // Replace spaces and special chars
                const filename = `${safeName}_Quote_${today.replace(/\//g, '-')}.pdf`;
                doc.save(filename);
                
                return filename;
                
            } catch (error) {
                console.error('PDF generation failed:', error);
                throw new Error('PDF generation failed: ' + error.message);
            }
        }
