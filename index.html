<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network TruckInsurance Services - Professional Quote Application</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header .contact-info {
            font-size: 16px;
            opacity: 0.95;
            margin: 15px 0;
        }
        
        .header .subtitle {
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 20px;
            margin-top: 20px;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 6px;
            position: relative;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .section {
            border-bottom: 1px solid #e9ecef;
        }
        
        .section:last-of-type {
            border-bottom: none;
        }
        
        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-left: 5px solid #3498db;
            font-weight: 600;
            color: #2c3e50;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .section-status {
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 20px;
            background: #e9ecef;
            color: #6c757d;
        }
        
        .section-status.complete {
            background: #d4edda;
            color: #155724;
        }
        
        .section-status.partial {
            background: #fff3cd;
            color: #856404;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .form-group.half-width {
            grid-column: span 1;
        }
        
        label {
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        input.error, select.error, textarea.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }
        
        input.valid, select.valid, textarea.valid {
            border-color: #27ae60;
            background-color: #f8fff9;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-item input[type="checkbox"] {
            transform: scale(1.3);
            margin: 0;
        }
        
        .notes {
            font-size: 12px;
            color: #6c757d;
            font-style: italic;
            margin-top: 4px;
        }
        
        .required {
            color: #e74c3c;
        }
        
        .entry-container {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            background: #fdfdfd;
            position: relative;
        }
        
        .entry-header {
            color: #3498db;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .btn-add {
            background: #27ae60;
            color: white;
            margin-top: 20px;
        }
        
        .btn-add:hover {
            background: #219a52;
            transform: translateY(-1px);
        }
        
        .btn-remove {
            background: #e74c3c;
            color: white;
            margin-top: 15px;
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 8px 16px;
            font-size: 12px;
        }
        
        .btn-remove:hover {
            background: #c0392b;
        }
        
        .coverage-grid {
            display: grid;
            gap: 20px;
        }
        
        .coverage-item {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            background: #fdfdfd;
            transition: all 0.2s ease;
        }
        
        .coverage-item.selected {
            border-color: #3498db;
            background: #f8fbff;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.1);
        }
        
        .coverage-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .coverage-header input[type="checkbox"] {
            transform: scale(1.4);
        }
        
        .coverage-title {
            font-weight: 600;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .coverage-details {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .percentage-tracker {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 6px;
            border: 2px solid #e9ecef;
            text-align: center;
            font-weight: 600;
            font-size: 16px;
        }
        
        .percentage-tracker.complete {
            background: #d4edda;
            border-color: #27ae60;
            color: #155724;
        }
        
        .percentage-tracker.over {
            background: #f8d7da;
            border-color: #e74c3c;
            color: #721c24;
        }
        
        .quote-summary {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .summary-header {
            color: #2c3e50;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .summary-label {
            font-weight: 600;
            color: #495057;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .summary-value {
            font-size: 16px;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        .btn-save {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 30px;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        
        .btn-save:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loading-spinner {
            display: none;
            margin-left: 10px;
        }
        
        .validation-summary {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .validation-summary h4 {
            color: #721c24;
            margin-bottom: 10px;
        }
        
        .validation-summary ul {
            margin-left: 20px;
            color: #721c24;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 0;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .btn-remove {
                position: static;
                margin-top: 15px;
                width: 100%;
            }
        }
        
        @media print {
            .btn, button {
                display: none;
            }
            
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Network TruckInsurance Services, Inc.</h1>
            <div class="contact-info">
                <strong>Ed Zahnle - Licensed Agent/Broker</strong><br>
                Phone: (509) 215-3433 | Email: ed.zahnle@truckerinsurance.com
            </div>
            <div class="subtitle">
                <h2>Professional Insurance Quote Application</h2>
                <p>Complete Commercial Trucking Insurance Solutions</p>
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Validation Summary -->
        <div class="validation-summary" id="validationSummary">
            <h4>Please Complete Required Fields:</h4>
            <ul id="validationList"></ul>
        </div>
        
        <form id="quoteForm" onsubmit="return false;" novalidate>
            <!-- Section 1: Business Information -->
            <div class="section">
                <div class="section-header">
                    <span>1. Business Information</span>
                    <span class="section-status" id="section1Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="businessName">Business Name <span class="required">*</span></label>
                            <input type="text" id="businessName" name="businessName" required 
                                   placeholder="Legal name of insured">
                            <div class="error-message">Business name is required</div>
                            <div class="notes">Legal business name as registered</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="dba">DBA (if different)</label>
                            <input type="text" id="dba" name="dba" 
                                   placeholder="Doing Business As name">
                            <div class="notes">Operating name if different from legal name</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="contactName">Contact Name <span class="required">*</span></label>
                            <input type="text" id="contactName" name="contactName" required 
                                   placeholder="Primary contact person">
                            <div class="error-message">Contact name is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number <span class="required">*</span></label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" required 
                                   placeholder="(555) 123-4567">
                            <div class="error-message">Valid phone number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="faxNumber">Fax Number</label>
                            <input type="tel" id="faxNumber" name="faxNumber" 
                                   placeholder="(555) 123-4567">
                        </div>
                        
                        <div class="form-group">
                            <label for="emailAddress">Email Address <span class="required">*</span></label>
                            <input type="email" id="emailAddress" name="emailAddress" required 
                                   placeholder="contact@company.com">
                            <div class="error-message">Valid email address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="businessAddress">Mailing Address <span class="required">*</span></label>
                            <input type="text" id="businessAddress" name="businessAddress" required 
                                   placeholder="Street Address" style="margin-bottom: 10px;">
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                <input type="text" id="businessCity" name="businessCity" required placeholder="City">
                                <input type="text" id="businessState" name="businessState" required placeholder="State">
                                <input type="text" id="businessZip" name="businessZip" required placeholder="ZIP Code">
                            </div>
                            <div class="error-message">Complete mailing address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <div class="checkbox-group" style="margin-bottom: 15px;">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="sameAsBusinessAddress" onchange="toggleGarageAddress()">
                                    <label for="sameAsBusinessAddress">Garage address same as mailing address</label>
                                </div>
                            </div>
                            <div id="garageAddressSection">
                                <label for="garageAddress">Garage Address <span class="required">*</span></label>
                                <input type="text" id="garageAddress" name="garageAddress" required 
                                       placeholder="Street Address" style="margin-bottom: 10px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                    <input type="text" id="garageCity" name="garageCity" required placeholder="City">
                                    <input type="text" id="garageState" name="garageState" required placeholder="State">
                                    <input type="text" id="garageZip" name="garageZip" required placeholder="ZIP Code">
                                </div>
                                <div class="error-message">Garage address is required</div>
                                <div class="notes">Where vehicles are parked overnight</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="businessType">Business Type <span class="required">*</span></label>
                            <select id="businessType" name="businessType" required>
                                <option value="">Select business type...</option>
                                <option value="Individual">Individual</option>
                                <option value="Partnership">Partnership</option>
                                <option value="Corporation">Corporation</option>
                                <option value="LLC">LLC</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Business type is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="usdotNumber">USDOT Number <span class="required">*</span></label>
                            <input type="text" id="usdotNumber" name="usdotNumber" required 
                                   placeholder="1234567">
                            <div class="error-message">USDOT number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="mcNumber">MC Number <span class="required">*</span></label>
                            <input type="text" id="mcNumber" name="mcNumber" required 
                                   placeholder="MC-123456">
                            <div class="error-message">MC number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="stateNumber">State Number</label>
                            <input type="text" id="stateNumber" name="stateNumber" 
                                   placeholder="CA-123456, TX-12345, etc.">
                            <div class="notes">State intrastate authority numbers</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="feinNumber">Federal EIN</label>
                            <input type="text" id="feinNumber" name="feinNumber" 
                                   placeholder="12-3456789">
                            <div class="notes">Federal Employer Identification Number</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="agencyNumber">Agency Number <span class="required">*</span></label>
                            <input type="text" id="agencyNumber" name="agencyNumber" required 
                                   placeholder="NTI-2024-001">
                            <div class="error-message">Agency number is required</div>
                            <div class="notes">Internal agency tracking identifier</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="yearsInBusiness">Years in Business <span class="required">*</span></label>
                            <select id="yearsInBusiness" name="yearsInBusiness" required>
                                <option value="">Select years in business...</option>
                                <option value="New Venture">New Venture</option>
                                <option value="<1">Less than 1 year</option>
                                <option value="1-3">1-3 years</option>
                                <option value="4-7">4-7 years</option>
                                <option value="8+">8+ years</option>
                            </select>
                            <div class="error-message">Years in business is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="grossReceipts">Annual Gross Receipts <span class="required">*</span></label>
                            <input type="text" id="grossReceipts" name="grossReceipts" required 
                                   placeholder="$500,000">
                            <div class="error-message">Annual gross receipts required</div>
                            <div class="notes">Current year estimated</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="priorYearReceipts">Prior Year Gross Receipts</label>
                            <input type="text" id="priorYearReceipts" name="priorYearReceipts" 
                                   placeholder="$450,000">
                            <div class="notes">Previous year actual</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 2: Driver Information -->
            <div class="section">
                <div class="section-header">
                    <span>2. Driver Information</span>
                    <span class="section-status" id="section2Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="driversContainer">
                        <!-- Driver entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addDriver()">+ Add Driver</button>
                </div>
            </div>
            
            <!-- Section 3: Vehicle Information -->
            <div class="section">
                <div class="section-header">
                    <span>3. Vehicle & Equipment Details</span>
                    <span class="section-status" id="section3Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="vehiclesContainer">
                        <!-- Vehicle entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addVehicle()">+ Add Vehicle</button>
                </div>
            </div>
            
            <!-- Section 4: Coverage Requirements -->
            <div class="section">
                <div class="section-header">
                    <span>4. Insurance Coverage Requirements</span>
                    <span class="section-status" id="section4Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="coverage-grid">
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="autoLiability" name="coverages" value="autoLiability" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="autoLiability">Primary Auto Liability</label>
                            </div>
                            <div class="notes">Required for commercial vehicle operation</div>
                            <div class="coverage-details" id="autoLiabilityDetails">
                                <div class="form-group">
                                    <label for="autoLiabilityLimit">Coverage Limit <span class="required">*</span></label>
                                    <select id="autoLiabilityLimit" name="autoLiabilityLimit">
                                        <option value="">Select limit...</option>
                                        <option value="750000">$750,000</option>
                                        <option value="1000000">$1,000,000</option>
                                        <option value="2000000">$2,000,000</option>
                                        <option value="5000000">$5,000,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="autoLiabilityDeductible">Deductible</label>
                                    <select id="autoLiabilityDeductible" name="autoLiabilityDeductible">
                                        <option value="0">$0</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="physicalDamage" name="coverages" value="physicalDamage" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="physicalDamage">Physical Damage</label>
                            </div>
                            <div class="notes">Comprehensive and collision coverage</div>
                            <div class="coverage-details" id="physicalDamageDetails">
                                <div class="form-group">
                                    <label for="comprehensiveDeductible">Comprehensive Deductible</label>
                                    <select id="comprehensiveDeductible" name="comprehensiveDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="500">$500</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="collisionDeductible">Collision Deductible</label>
                                    <select id="collisionDeductible" name="collisionDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                        <option value="10000">$10,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="cargoInsurance" name="coverages" value="cargoInsurance" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="cargoInsurance">Cargo Insurance</label>
                            </div>
                            <div class="notes">Coverage for transported goods</div>
                            <div class="coverage-details" id="cargoInsuranceDetails">
                                <div class="form-group">
                                    <label for="cargoLimit">Coverage Limit</label>
                                    <select id="cargoLimit" name="cargoLimit">
                                        <option value="">Select limit...</option>
                                        <option value="100000">$100,000</option>
                                        <option value="250000">$250,000</option>
                                        <option value="500000">$500,000</option>
                                        <option value="1000000">$1,000,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="cargoDeductible">Deductible</label>
                                    <select id="cargoDeductible" name="cargoDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="reeferBreakdown" name="reeferBreakdown" value="yes">
                                        <label for="reeferBreakdown">Refrigeration Breakdown ($2,500 deductible)</label>
                                    </div>
                                    <div class="notes">Coverage for refrigerated trailer mechanical breakdown</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="generalLiability" name="coverages" value="generalLiability" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="generalLiability">General Liability</label>
                            </div>
                            <div class="notes">$1M per occurrence / $2M aggregate</div>
                            <div class="coverage-details" id="generalLiabilityDetails">
                                <div class="form-group">
                                    <label for="generalLiabilityLimit">Coverage Structure</label>
                                    <select id="generalLiabilityLimit" name="generalLiabilityLimit">
                                        <option value="">Select limit...</option>
                                        <option value="1M/2M">$1,000,000 per occurrence / $2,000,000 aggregate</option>
                                        <option value="2M/4M">$2,000,000 per occurrence / $4,000,000 aggregate</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="glDeductible">Deductible</label>
                                    <select id="glDeductible" name="glDeductible">
                                        <option value="0">$0</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="trilerInterchange" name="coverages" value="trailerInterchange" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="trilerInterchange">Trailer Interchange</label>
                            </div>
                            <div class="notes">Non-owned trailer coverage</div>
                            <div class="coverage-details" id="trilerInterchangeDetails">
                                <div class="form-group">
                                    <label for="trailerInterchangeLimit">Coverage Limit</label>
                                    <select id="trailerInterchangeLimit" name="trailerInterchangeLimit">
                                        <option value="">Select limit...</option>
                                        <option value="35000">$35,000</option>
                                        <option value="50000">$50,000</option>
                                        <option value="75000">$75,000</option>
                                        <option value="100000">$100,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="trailerDeductible">Deductible</label>
                                    <select id="trailerDeductible" name="trailerDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 5: Commodity Information -->
            <div class="section">
                <div class="section-header">
                    <span>5. Commodity & Cargo Information</span>
                    <span class="section-status" id="section5Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid" style="margin-bottom: 20px;">
                        <div class="form-group">
                            <label for="routesOfTravel">Routes of Travel <span class="required">*</span></label>
                            <textarea id="routesOfTravel" name="routesOfTravel" required rows="2" 
                                      placeholder="Major cities and regions served (e.g., Los Angeles, Las Vegas, Phoenix)"></textarea>
                            <div class="error-message">Routes of travel is required</div>
                        </div>
                        
                        <div class="form-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="exclusiveHaul" name="exclusiveHaul" value="yes" onchange="toggleExclusiveHaulDetails()">
                                <label for="exclusiveHaul">Exclusive haul?</label>
                            </div>
                            <div id="exclusiveHaulDetails" style="display: none; margin-top: 10px;">
                                <input type="text" id="exclusiveHaulFor" name="exclusiveHaulFor" placeholder="Company name and years">
                                <div class="notes">If yes, for whom and how many years?</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="hazmatHaul" name="hazmatHaul" value="yes" onchange="toggleHazmatDetails()">
                                <label for="hazmatHaul">Hauling hazardous materials?</label>
                            </div>
                            <div id="hazmatDetails" style="display: none; margin-top: 10px;">
                                <textarea id="hazmatTypes" name="hazmatTypes" rows="2" placeholder="List hazmat classes and materials"></textarea>
                                <div class="notes">Please specify hazmat classes and materials</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="commoditiesContainer">
                        <!-- Commodity entries will be added here -->
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                        <button type="button" class="btn btn-add" onclick="addCommodity()">+ Add Commodity</button>
                        <div class="percentage-tracker" id="percentageTracker">Total: 0%</div>
                    </div>
                </div>
            </div>
            
            <!-- Section 6: Loss History -->
            <div class="section">
                <div class="section-header">
                    <span>6. Loss History & Claims</span>
                    <span class="section-status" id="section6Status">Complete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="priorCarrier">Current/Prior Insurance Carrier</label>
                            <input type="text" id="priorCarrier" name="priorCarrier" 
                                   placeholder="Insurance company name">
                        </div>
                        
                        <div class="form-group">
                            <label for="policyNumber">Policy Number</label>
                            <input type="text" id="policyNumber" name="policyNumber" 
                                   placeholder="Current policy number">
                        </div>
                        
                        <div class="form-group">
                            <label for="claimsLast5Years">Claims in Last 5 Years</label>
                            <select id="claimsLast5Years" name="claimsLast5Years">
                                <option value="0">No claims</option>
                                <option value="1">1 claim</option>
                                <option value="2">2 claims</option>
                                <option value="3">3 claims</option>
                                <option value="4+">4 or more claims</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="totalPaidOut">Total Paid Out</label>
                            <input type="text" id="totalPaidOut" name="totalPaidOut" 
                                   placeholder="$0">
                            <div class="notes">Total amount paid on all claims</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="claimsDescription">Claims Description (if applicable)</label>
                            <textarea id="claimsDescription" name="claimsDescription" rows="3" 
                                      placeholder="Brief description of any claims with dates..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quote Summary Section -->
            <div class="quote-summary">
                <div class="summary-header">Quote Summary</div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Quote ID (USDOT)</div>
                        <div class="summary-value" id="quoteId">Enter USDOT number</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Date Created</div>
                        <div class="summary-value" id="quoteDate">Loading...</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Agency Number</div>
                        <div class="summary-value" id="summaryAgencyNumber">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Business Name</div>
                        <div class="summary-value" id="summaryBusinessName">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Contact</div>
                        <div class="summary-value" id="summaryContactName">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Vehicles</div>
                        <div class="summary-value" id="summaryVehicleCount">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Drivers</div>
                        <div class="summary-value" id="summaryDriverCount">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Coverage Types</div>
                        <div class="summary-value" id="summaryCoverageCount">0 selected</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Submission Status</div>
                        <div class="summary-value" id="submissionStatus">Ready to Submit</div>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Submit Button -->
        <div style="text-align: center; padding: 30px;">
            <button type="button" class="btn-save" style="background: #e67e22; margin-right: 15px;" onclick="quickFillDemo()">
                Fill Demo Data (Texas 2-Truck Account)
            </button>
            <button type="button" class="btn-save" id="submitBtn" onclick="submitQuote()">
                Generate Professional Quote PDF
                <span class="loading-spinner" id="loadingSpinner">‚ü≥</span>
            </button>
        </div>
    </div>
    
    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Replace with your actual Google Apps Script Web App URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxrcWAKtm8dDicdDNRToxyaR1YKzFHHBan-tJww4fNT9ZkDfHBZEXHdC14CChFMGexY/exec';
        
        // Global counters
        let driverCount = 0;
        let vehicleCount = 0;
        let commodityCount = 0;
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeQuote();
            addDriver(); // Add first driver
            addVehicle(); // Add first vehicle
            addCommodity(); // Add first commodity
            setupEventListeners();
        });
        
        function initializeQuote() {
            const today = new Date();
            const dateString = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById('quoteId').textContent = 'Enter USDOT number';
            document.getElementById('quoteDate').textContent = dateString;
        }
        
        function updateQuoteId() {
            const usdotNumber = document.getElementById('usdotNumber').value;
            const quoteId = usdotNumber ? `DOT-${usdotNumber}` : 'Enter USDOT number';
            document.getElementById('quoteId').textContent = quoteId;
            return quoteId;
        }
        
        function setupEventListeners() {
            const form = document.getElementById('quoteForm');
            const inputs = form.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                input.addEventListener('input', validateField);
                input.addEventListener('blur', validateField);
                input.addEventListener('change', updateProgress);
            });
            
            // Update summary on changes
            document.getElementById('businessName').addEventListener('input', function() {
                document.getElementById('summaryBusinessName').textContent = this.value || 'Not entered';
            });
            
            document.getElementById('contactName').addEventListener('input', function() {
                document.getElementById('summaryContactName').textContent = this.value || 'Not entered';
            });
            
            document.getElementById('agencyNumber').addEventListener('input', function() {
                document.getElementById('summaryAgencyNumber').textContent = this.value || 'Not entered';
            });
            
            document.getElementById('usdotNumber').addEventListener('input', function() {
                updateQuoteId();
            });
        }
        
        function validateField(event) {
            const field = event.target;
            const value = field.value.trim();
            const isRequired = field.hasAttribute('required');
            
            // Clear previous validation state
            field.classList.remove('error', 'valid');
            const errorMsg = field.parentNode.querySelector('.error-message');
            if (errorMsg) {
                errorMsg.style.display = 'none';
            }
            
            if (isRequired && !value) {
                field.classList.add('error');
                if (errorMsg) {
                    errorMsg.style.display = 'block';
                }
                return false;
            }
            
            // Field-specific validation
            if (field.type === 'email' && value) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(value)) {
                    field.classList.add('error');
                    if (errorMsg) {
                        errorMsg.textContent = 'Please enter a valid email address';
                        errorMsg.style.display = 'block';
                    }
                    return false;
                }
            }
            
            if (field.type === 'tel' && value) {
                const phoneRegex = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
                if (!phoneRegex.test(value)) {
                    field.classList.add('error');
                    if (errorMsg) {
                        errorMsg.textContent = 'Please enter a valid phone number';
                        errorMsg.style.display = 'block';
                    }
                    return false;
                }
            }
            
            if (value) {
                field.classList.add('valid');
            }
            
            return true;
        }
        
        function updateProgress() {
            const form = document.getElementById('quoteForm');
            const requiredFields = form.querySelectorAll('[required]');
            const completedFields = Array.from(requiredFields).filter(field => field.value.trim() !== '');
            
            const progressPercent = (completedFields.length / requiredFields.length) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            
            // Update section statuses
            updateSectionStatus('section1Status', checkSectionComplete(1));
            updateSectionStatus('section2Status', checkSectionComplete(2));
            updateSectionStatus('section3Status', checkSectionComplete(3));
            updateSectionStatus('section4Status', checkSectionComplete(4));
            updateSectionStatus('section5Status', checkSectionComplete(5));
            
            // Update summary counts
            updateSummaryCounts();
        }
        
        function checkSectionComplete(sectionNumber) {
            const section = document.querySelector(`.section:nth-child(${sectionNumber + 1})`);
            const requiredFields = section?.querySelectorAll('[required]') || [];
            const completedFields = Array.from(requiredFields).filter(field => field.value.trim() !== '');
            
            if (requiredFields.length === 0) return 'complete';
            if (completedFields.length === 0) return 'incomplete';
            if (completedFields.length === requiredFields.length) return 'complete';
            return 'partial';
        }
        
        function updateSectionStatus(elementId, status) {
            const element = document.getElementById(elementId);
            element.textContent = status.charAt(0).toUpperCase() + status.slice(1);
            element.className = 'section-status ' + status;
        }
        
        function updateSummaryCounts() {
            const driverEntries = document.querySelectorAll('#driversContainer .entry-container');
            const vehicleEntries = document.querySelectorAll('#vehiclesContainer .entry-container');
            const selectedCoverages = document.querySelectorAll('input[name="coverages"]:checked');
            
            document.getElementById('summaryDriverCount').textContent = driverEntries.length;
            document.getElementById('summaryVehicleCount').textContent = vehicleEntries.length;
            document.getElementById('summaryCoverageCount').textContent = selectedCoverages.length + ' selected';
        }
        
        function toggleGarageAddress() {
            const checkbox = document.getElementById('sameAsBusinessAddress');
            const garageSection = document.getElementById('garageAddressSection');
            const garageFields = garageSection.querySelectorAll('input');
            
            if (checkbox.checked) {
                garageSection.style.display = 'none';
                
                // Copy business address to garage fields
                document.getElementById('garageAddress').value = document.getElementById('businessAddress').value;
                document.getElementById('garageCity').value = document.getElementById('businessCity').value;
                document.getElementById('garageState').value = document.getElementById('businessState').value;
                document.getElementById('garageZip').value = document.getElementById('businessZip').value;
                
                // Remove required attribute
                garageFields.forEach(field => field.removeAttribute('required'));
            } else {
                garageSection.style.display = 'block';
                
                // Add required attribute back
                garageFields.forEach(field => field.setAttribute('required', 'required'));
                
                // Clear garage fields
                garageFields.forEach(field => field.value = '');
            }
        }
        
        function toggleExclusiveHaulDetails() {
            const checkbox = document.getElementById('exclusiveHaul');
            const details = document.getElementById('exclusiveHaulDetails');
            details.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function toggleHazmatDetails() {
            const checkbox = document.getElementById('hazmatHaul');
            const details = document.getElementById('hazmatDetails');
            details.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function addDriver() {
            driverCount++;
            const container = document.getElementById('driversContainer');
            
            const driverHtml = `
                <div class="entry-container" data-driver="${driverCount}">
                    ${driverCount > 1 ? `<button type="button" class="btn-remove" onclick="removeDriver(${driverCount})">Remove</button>` : ''}
                    <div class="entry-header">Driver #${driverCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Driver Name <span class="required">*</span></label>
                            <input type="text" name="driver_${driverCount}_name" required placeholder="Full legal name">
                            <div class="error-message">Driver name is required</div>
                        </div>
                        <div class="form-group">
                            <label>Driver License Number <span class="required">*</span></label>
                            <input type="text" name="driver_${driverCount}_license" required placeholder="License number">
                            <div class="error-message">License number is required</div>
                        </div>
                        <div class="form-group">
                            <label>Date of Birth <span class="required">*</span></label>
                            <input type="date" name="driver_${driverCount}_dob" required>
                            <div class="error-message">Date of birth is required</div>
                        </div>
                        <div class="form-group">
                            <label>Years of Experience <span class="required">*</span></label>
                            <select name="driver_${driverCount}_experience" required>
                                <option value="">Select experience...</option>
                                <option value="<1">Less than 1 year</option>
                                <option value="1-3">1-3 years</option>
                                <option value="4-7">4-7 years</option>
                                <option value="8-12">8-12 years</option>
                                <option value="13-20">13-20 years</option>
                                <option value="20+">20+ years</option>
                            </select>
                            <div class="error-message">Experience level is required</div>
                        </div>
                        <div class="form-group">
                            <label>Date of Hire</label>
                            <input type="date" name="driver_${driverCount}_doh" placeholder="Date hired">
                        </div>
                        <div class="form-group">
                            <label>Social Security Number (last 4 digits)</label>
                            <input type="text" name="driver_${driverCount}_ssn" placeholder="####" maxlength="4">
                            <div class="notes">Last 4 digits only for identification</div>
                        </div>
                        <div class="form-group full-width">
                            <label>Violations/Accidents (Last 3 Years)</label>
                            <textarea name="driver_${driverCount}_violations" rows="2" 
                                      placeholder="List any violations, accidents, or claims with dates..."></textarea>
                            <div class="notes">Include dates, nature of violation/accident, and any fines</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', driverHtml);
            
            // Add event listeners to new fields
            const newDriverContainer = container.lastElementChild;
            const newFields = newDriverContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
        }
        
        function removeDriver(driverNumber) {
            const driverElement = document.querySelector(`[data-driver="${driverNumber}"]`);
            if (driverElement) {
                driverElement.remove();
                updateProgress();
            }
        }
        
        function addVehicle() {
            vehicleCount++;
            const container = document.getElementById('vehiclesContainer');
            
            const vehicleHtml = `
                <div class="entry-container" data-vehicle="${vehicleCount}">
                    ${vehicleCount > 1 ? `<button type="button" class="btn-remove" onclick="removeVehicle(${vehicleCount})">Remove</button>` : ''}
                    <div class="entry-header">Vehicle #${vehicleCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Year <span class="required">*</span></label>
                            <input type="number" name="vehicle_${vehicleCount}_year" required 
                                   placeholder="2020" min="1990" max="2025">
                            <div class="error-message">Year is required</div>
                        </div>
                        <div class="form-group">
                            <label>Make <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_make" required>
                                <option value="">Select make...</option>
                                <option value="Freightliner">Freightliner</option>
                                <option value="Peterbilt">Peterbilt</option>
                                <option value="Kenworth">Kenworth</option>
                                <option value="Volvo">Volvo</option>
                                <option value="Mack">Mack</option>
                                <option value="International">International</option>
                                <option value="Western Star">Western Star</option>
                                <option value="Ford">Ford</option>
                                <option value="Chevrolet">Chevrolet</option>
                                <option value="GMC">GMC</option>
                                <option value="RAM">RAM</option>
                                <option value="Isuzu">Isuzu</option>
                                <option value="Hino">Hino</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Make is required</div>
                        </div>
                        <div class="form-group">
                            <label>Body Type <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_body_type" required>
                                <option value="">Select body type...</option>
                                <option value="TT">Truck Tractor</option>
                                <option value="SU">Straight Truck</option>
                                <option value="Pickup">Pickup Truck</option>
                                <option value="Van">Van</option>
                                <option value="Trailer">Trailer</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Body type is required</div>
                        </div>
                        <div class="form-group">
                            <label>GVW Rating <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_gvw" required>
                                <option value="">Select GVW...</option>
                                <option value="80000">80,000+ lbs</option>
                                <option value="60000">60,001-80,000 lbs</option>
                                <option value="40000">40,001-60,000 lbs</option>
                                <option value="26000">26,001-40,000 lbs</option>
                                <option value="10000">10,001-26,000 lbs</option>
                                <option value="<10000">Under 10,001 lbs</option>
                            </select>
                            <div class="error-message">GVW rating is required</div>
                        </div>
                        <div class="form-group">
                            <label>VIN <span class="required">*</span></label>
                            <input type="text" name="vehicle_${vehicleCount}_vin" required 
                                   placeholder="17-digit VIN number" maxlength="17">
                            <div class="error-message">VIN is required</div>
                        </div>
                        <div class="form-group">
                            <label>Vehicle Value <span class="required">*</span></label>
                            <input type="text" name="vehicle_${vehicleCount}_value" required 
                                   placeholder="$85,000">
                            <div class="error-message">Vehicle value is required</div>
                            <div class="notes">Current market/replacement value</div>
                        </div>
                        <div class="form-group">
                            <label>Annual Miles <span class="required">*</span></label>
                            <input type="number" name="vehicle_${vehicleCount}_annual_miles" required 
                                   placeholder="100000" min="0">
                            <div class="error-message">Annual miles is required</div>
                        </div>
                        <div class="form-group">
                            <label>Operating Radius <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_radius" required>
                                <option value="">Select radius...</option>
                                <option value="50">0-50 miles (Local)</option>
                                <option value="100">51-100 miles (Local)</option>
                                <option value="200">101-200 miles (Intermediate)</option>
                                <option value="500">201-500 miles (Regional)</option>
                                <option value="1000">501-1000+ miles (Long haul)</option>
                                <option value="Unlimited">Unlimited</option>
                            </select>
                            <div class="error-message">Operating radius is required</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', vehicleHtml);
            
            // Add event listeners to new fields
            const newVehicleContainer = container.lastElementChild;
            const newFields = newVehicleContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
        }
        
        function removeVehicle(vehicleNumber) {
            const vehicleElement = document.querySelector(`[data-vehicle="${vehicleNumber}"]`);
            if (vehicleElement) {
                vehicleElement.remove();
                updateProgress();
            }
        }
        
        function addCommodity() {
            commodityCount++;
            const container = document.getElementById('commoditiesContainer');
            
            const commodityHtml = `
                <div class="entry-container" data-commodity="${commodityCount}">
                    ${commodityCount > 1 ? `<button type="button" class="btn-remove" onclick="removeCommodity(${commodityCount})">Remove</button>` : ''}
                    <div class="entry-header">Commodity #${commodityCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Commodity Type <span class="required">*</span></label>
                            <select name="commodity_${commodityCount}_type" required>
                                <option value="">Select commodity...</option>
                                <option value="General Freight">General Freight</option>
                                <option value="Refrigerated">Refrigerated</option>
                                <option value="Flatbed">Flatbed</option>
                                <option value="Dry Van">Dry Van</option>
                                <option value="Tanker">Tanker</option>
                                <option value="Auto Hauler">Auto Hauler</option>
                                <option value="Heavy Haul">Heavy Haul</option>
                                <option value="Container">Container</option>
                                <option value="Intermodal">Intermodal</option>
                                <option value="Hazmat">Hazmat</option>
                                <option value="Dump Truck">Dump Truck</option>
                                <option value="Box Truck">Box Truck</option>
                                <option value="Lumber">Lumber</option>
                                <option value="Steel">Steel</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Commodity type is required</div>
                        </div>
                        <div class="form-group">
                            <label>Percentage of Loads <span class="required">*</span></label>
                            <input type="number" name="commodity_${commodityCount}_percentage" required 
                                   min="1" max="100" placeholder="50" onchange="updatePercentageTotal()">
                            <div class="error-message">Percentage is required</div>
                            <div class="notes">% of total annual loads</div>
                        </div>
                        <div class="form-group">
                            <label>Average Load Value</label>
                            <input type="text" name="commodity_${commodityCount}_avg_value" 
                                   placeholder="$25,000">
                            <div class="notes">Typical cargo value per load</div>
                        </div>
                        <div class="form-group">
                            <label>Maximum Load Value</label>
                            <input type="text" name="commodity_${commodityCount}_max_value" 
                                   placeholder="$50,000">
                            <div class="notes">Highest value load transported</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', commodityHtml);
            
            // Add event listeners to new fields
            const newCommodityContainer = container.lastElementChild;
            const newFields = newCommodityContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
            updatePercentageTotal();
        }
        
        function removeCommodity(commodityNumber) {
            const commodityElement = document.querySelector(`[data-commodity="${commodityNumber}"]`);
            if (commodityElement) {
                commodityElement.remove();
                updatePercentageTotal();
                updateProgress();
            }
        }
        
        function updatePercentageTotal() {
            const percentageInputs = document.querySelectorAll('input[name*="commodity_"][name*="_percentage"]');
            let total = 0;
            
            percentageInputs.forEach(input => {
                total += parseInt(input.value) || 0;
            });
            
            const tracker = document.getElementById('percentageTracker');
            tracker.textContent = `Total: ${total}%`;
            
            // Update styling
            tracker.className = 'percentage-tracker';
            if (total === 100) {
                tracker.classList.add('complete');
            } else if (total > 100) {
                tracker.classList.add('over');
            }
        }
        
        function toggleCoverageDetails(checkbox) {
            const coverageItem = checkbox.closest('.coverage-item');
            const details = coverageItem.querySelector('.coverage-details');
            
            if (checkbox.checked) {
                details.style.display = 'grid';
                coverageItem.classList.add('selected');
            } else {
                details.style.display = 'none';
                coverageItem.classList.remove('selected');
                
                // Clear values in hidden details
                const inputs = details.querySelectorAll('input, select');
                inputs.forEach(input => input.value = '');
            }
            
            updateProgress();
        }
        
        function validateForm() {
            const form = document.getElementById('quoteForm');
            const requiredFields = form.querySelectorAll('[required]');
            const errors = [];
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    errors.push(field.previousElementSibling.textContent.replace(' *', ''));
                    field.classList.add('error');
                } else {
                    field.classList.remove('error');
                }
            });
            
            // Check commodity percentages
            const percentageInputs = document.querySelectorAll('input[name*="commodity_"][name*="_percentage"]');
            let total = 0;
            percentageInputs.forEach(input => total += parseInt(input.value) || 0);
            
            if (total !== 100 && percentageInputs.length > 0) {
                errors.push('Commodity percentages must total 100%');
            }
            
            // Check if at least one coverage is selected
            const selectedCoverages = document.querySelectorAll('input[name="coverages"]:checked');
            if (selectedCoverages.length === 0) {
                errors.push('At least one insurance coverage must be selected');
            }
            
            // Display validation summary
            const validationSummary = document.getElementById('validationSummary');
            const validationList = document.getElementById('validationList');
            
            if (errors.length > 0) {
                validationList.innerHTML = errors.map(error => `<li>${error}</li>`).join('');
                validationSummary.style.display = 'block';
                validationSummary.scrollIntoView({ behavior: 'smooth', block: 'start' });
                return false;
            } else {
                validationSummary.style.display = 'none';
                return true;
            }
        }
        
        function collectFormData() {
            const form = document.getElementById('quoteForm');
            const formData = new FormData(form);
            const data = {};
            
            // Convert FormData to object
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Collect checkbox values
            const checkboxes = form.querySelectorAll('input[type="checkbox"]:checked');
            checkboxes.forEach(checkbox => {
                data[checkbox.name] = checkbox.value;
            });
            
            // Use USDOT number as quote ID
            const usdotNumber = document.getElementById('usdotNumber').value;
            data.quoteId = usdotNumber ? `DOT-${usdotNumber}` : 'NO-USDOT';
            data.submissionDate = new Date().toISOString();
            data.driverCount = document.querySelectorAll('#driversContainer .entry-container').length;
            data.vehicleCount = document.querySelectorAll('#vehiclesContainer .entry-container').length;
            data.commodityCount = document.querySelectorAll('#commoditiesContainer .entry-container').length;
            
            // Collect selected coverages
            const selectedCoverages = Array.from(document.querySelectorAll('input[name="coverages"]:checked'))
                .map(checkbox => checkbox.value);
            data.selectedCoverages = selectedCoverages;
            
            return data;
        }
        
        async function submitToGoogleSheets(formData) {
            try {
                console.log('Submitting to Google Sheets:', formData);
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                console.log('Google Sheets response:', result);
                
                if (result.status === 'success') {
                    console.log('Successfully submitted to Google Sheets - Row:', result.rowNumber);
                    return true;
                } else {
                    console.error('Google Sheets submission failed:', result.message);
                    return false;
                }
                
            } catch (error) {
                console.error('Error submitting to Google Sheets:', error);
                return false;
            }
        }

        async function sendDocumentRequestEmail(formData) {
            try {
                console.log('Sending document request email to:', formData.emailAddress);
                
                const emailData = {
                    action: 'sendDocumentRequest',
                    from: 'ed.zahnle@truckerinsurance.com',
                    to: formData.emailAddress,
                    cc: 'ed.zahnle@truckerinsurance.com',
                    subject: `Document Request - Commercial Trucking Insurance Quote ${formData.quoteId}`,
                    html: generateEmailHTML(formData)
                };
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(emailData)
                });
                
                const result = await response.json();
                console.log('Email response:', result);
                
                if (result.status === 'success') {
                    console.log('Document request email sent successfully');
                    return true;
                } else {
                    console.error('Email sending failed:', result.message);
                    return false;
                }
                
            } catch (error) {
                console.error('Error sending document request email:', error);
                return false;
            }
        }

        function generateEmailHTML(formData) {
            return `
                <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                    <div style="background: linear-gradient(135deg, #2c3e50, #3498db); color: white; padding: 20px; text-align: center;">
                        <h2>Network TruckInsurance Services, Inc.</h2>
                        <p>Ed Zahnle - Licensed Agent/Broker<br>
                        Phone: (509) 215-3433 | Email: ed.zahnle@truckerinsurance.com</p>
                    </div>
                    
                    <div style="padding: 30px; background: white;">
                        <p>Dear ${formData.contactName},</p>
                        
                        <p>Thank you for submitting your commercial trucking insurance quote request. I have received your application and am excited to help you secure competitive coverage for <strong>${formData.businessName}</strong>.</p>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-left: 4px solid #3498db; margin: 20px 0;">
                            <h3 style="color: #2c3e50; margin-top: 0;">Quote Summary:</h3>
                            <ul style="margin: 10px 0;">
                                <li><strong>Quote ID:</strong> ${formData.quoteId}</li>
                                <li><strong>Agency Number:</strong> ${formData.agencyNumber}</li>
                                <li><strong>Business:</strong> ${formData.businessName}</li>
                                <li><strong>USDOT:</strong> ${formData.usdotNumber}</li>
                                <li><strong>MC Number:</strong> ${formData.mcNumber}</li>
                                <li><strong>Fleet Size:</strong> ${formData.vehicleCount} vehicles, ${formData.driverCount} drivers</li>
                            </ul>
                        </div>
                        
                        <p>To complete your quote package and provide you with accurate pricing from our top-rated carriers (Progressive, Sentry, BHHC), I will need the following documents:</p>
                        
                        <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0;">
                            <h3 style="color: #856404; margin-top: 0;">üìã Required Documents:</h3>
                            <ol style="color: #856404;">
                                <li><strong>Loss Runs from your current/prior insurance carrier</strong> (last 5 years)
                                    <br><small>‚Ä¢ This shows your claims history and is required by all underwriters</small>
                                </li>
                                <li><strong>IFTA Reports</strong> (last 4 quarters)
                                    <br><small>‚Ä¢ Interstate Fuel Tax Agreement reports showing mileage by state</small>
                                </li>
                                <li><strong>Motor Vehicle Records (MVRs)</strong> - <em>We will handle ordering these directly</em>
                                    <br><small>‚Ä¢ No action needed from you on MVRs</small>
                                </li>
                            </ol>
                        </div>
                        
                        <div style="background: #d4edda; padding: 20px; border-radius: 8px; margin: 20px 0;">
                            <h3 style="color: #155724; margin-top: 0;">üöÄ Need Help Getting Loss Runs?</h3>
                            <p style="color: #155724; margin-bottom: 0;">Many carriers require written authorization to release loss runs to agents. <strong>I can create the official request documents for you and send them via Adobe Sign for electronic signature.</strong> This makes the process quick and ensures your current carrier has everything they need to release your loss run history.</p>
                            
                            <p style="color: #155724; margin-bottom: 0;"><strong>Just reply to this email and let me know if you'd like me to prepare the loss run request documents for Adobe Sign!</strong></p>
                        </div>
                        
                        <h3 style="color: #2c3e50;">Next Steps:</h3>
                        <ol>
                            <li>Reply to this email with your IFTA reports (PDF format preferred)</li>
                            <li>Contact your current insurance carrier to request loss runs, or let me help with Adobe Sign requests</li>
                            <li>I'll order MVRs for all drivers once we receive the above documents</li>
                            <li>Within 24-48 hours of receiving all documents, I'll present you with competitive quotes from multiple carriers</li>
                        </ol>
                        
                        <div style="background: #e9ecef; padding: 15px; border-radius: 8px; margin: 20px 0;">
                            <p style="margin: 0; font-size: 14px;"><strong>Questions?</strong> Don't hesitate to call me directly at (509) 215-3433. I'm here to make this process as smooth as possible and ensure you get the best coverage at competitive rates.</p>
                        </div>
                        
                        <p>Thank you for choosing Network TruckInsurance Services. I look forward to working with you!</p>
                        
                        <p>Best regards,<br>
                        <strong>Ed Zahnle</strong><br>
                        Licensed Insurance Agent/Broker<br>
                        Network TruckInsurance Services, Inc.<br>
                        Direct: (509) 215-3433<br>
                        Email: ed.zahnle@truckerinsurance.com</p>
                    </div>
                    
                    <div style="background: #2c3e50; color: white; padding: 15px; text-align: center; font-size: 12px;">
                        <p style="margin: 0;">This email was sent regarding your commercial trucking insurance quote request ${formData.quoteId}.<br>
                        Network TruckInsurance Services, Inc. | Licensed Agent Ed Zahnle</p>
                    </div>
                </div>
            `;
        }
        
        function generateProfessionalPDF(formData) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            let yPosition = 15;
            
            // Header with border box
            doc.setLineWidth(0.5);
            doc.rect(15, 10, 180, 25);
            
            // Main title
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('TRUCKERS QUOTE SHEET', 105, yPosition + 5, { align: 'center' });
            
            // Company info box (right side)
            doc.rect(140, 10, 55, 25);
            doc.setFontSize(10);
            doc.text('Network Truck', 142, yPosition + 5);
            doc.text('Insurance Services, Inc.', 142, yPosition + 9);
            doc.text('PH (509) 215-3433', 142, yPosition + 13);
            doc.text('FAX Available upon request', 142, yPosition + 17);
            
            // Agent info (left side)
            doc.setFontSize(9);
            doc.text(`AGENT: Ed Zahnle`, 17, yPosition + 5);
            doc.text(`CLIENT# ${formData.quoteId}`, 17, yPosition + 9);
            doc.text(`AGENCY# ${formData.agencyNumber || ''}`, 17, yPosition + 13);
            doc.text(`Lic# OD48006`, 17, yPosition + 17);
            
            yPosition = 40;
            
            // Date line
            doc.setFontSize(9);
            const today = new Date().toLocaleDateString('en-US');
            doc.text(`Todays Date ${today}`, 15, yPosition);
            doc.text(`Effective Date TBD`, 85, yPosition);
            doc.text(`TARGET PRICE TBD`, 155, yPosition);
            
            yPosition += 8;
            
            // Business information section - compact format
            doc.text(`Legal Name`, 15, yPosition);
            doc.text(`${formData.businessName || ''}`, 45, yPosition);
            doc.text(`Telephone#`, 120, yPosition);
            doc.text(`${formData.phoneNumber || ''}`, 145, yPosition);
            
            yPosition += 5;
            if (formData.dba) {
                doc.text(`DBA:`, 15, yPosition);
                doc.text(`${formData.dba}`, 45, yPosition);
                yPosition += 5;
            }
            
            doc.text(`Fax#`, 120, yPosition);
            doc.text(`${formData.faxNumber || ''}`, 145, yPosition);
            
            yPosition += 5;
            doc.text(`Mailing Address`, 15, yPosition);
            doc.text(`${formData.businessAddress || ''}`, 45, yPosition);
            doc.text(`Pgr/Mob#`, 120, yPosition);
            
            yPosition += 5;
            doc.text(`${formData.businessCity || ''} ${formData.businessState || ''} ${formData.businessZip || ''}`, 45, yPosition);
            
            // Business type checkboxes
            yPosition += 5;
            const businessType = formData.businessType || '';
            doc.text(`${businessType === 'Individual' ? '‚òë' : '‚òê'} Individual`, 15, yPosition);
            doc.text(`${businessType === 'Partnership' ? '‚òë' : '‚òê'} Partner`, 45, yPosition);
            doc.text(`${businessType === 'Corporation' || businessType === 'LLC' ? '‚òë' : '‚òê'} Corp`, 75, yPosition);
            
            yPosition += 8;
            
            // Garage address section
            doc.text(`Garaging Address`, 15, yPosition);
            if (document.getElementById('sameAsBusinessAddress').checked) {
                doc.text(`Same as above`, 45, yPosition);
            } else {
                doc.text(`${formData.garageAddress || ''}`, 45, yPosition);
                yPosition += 4;
                doc.text(`${formData.garageCity || ''} ${formData.garageState || ''} ${formData.garageZip || ''}`, 45, yPosition);
            }
            
            doc.text(`State# ${formData.stateNumber || ''}`, 120, yPosition);
            doc.text(`MC# ${formData.mcNumber || ''}`, 155, yPosition);
            
            yPosition += 5;
            doc.text(`USDOT: ${formData.usdotNumber || ''}`, 120, yPosition);
            doc.text(`Other filings?`, 155, yPosition);
            
            yPosition += 8;
            
            // Years in business
            doc.text(`Years in Business`, 15, yPosition);
            doc.text(`${formData.yearsInBusiness || ''}`, 50, yPosition);
            doc.text(`New Venture? ‚òê Yes ‚òê No`, 85, yPosition);
            doc.text(`If yes, previous employer`, 130, yPosition);
            
            yPosition += 5;
            doc.text(`Exclusive haul?`, 15, yPosition);
            const exclusiveHaul = document.getElementById('exclusiveHaul').checked;
            doc.text(`${exclusiveHaul ? '‚òë' : '‚òê'} Yes ${exclusiveHaul ? '‚òê' : '‚òë'} No`, 45, yPosition);
            if (exclusiveHaul) {
                doc.text(`If yes, how many years & for whom?`, 75, yPosition);
                doc.text(`${formData.exclusiveHaulFor || ''}`, 130, yPosition);
            }
            
            yPosition += 8;
            
            // Commodities - compact format
            doc.text(`Commodity Hauled (percentage)`, 15, yPosition);
            const commodities = [];
            for (let i = 1; i <= commodityCount; i++) {
                const type = formData[`commodity_${i}_type`];
                const percentage = formData[`commodity_${i}_percentage`];
                if (type && percentage) {
                    commodities.push(`${type} ${percentage}%`);
                }
            }
            doc.text(commodities.join(', '), 70, yPosition);
            
            yPosition += 5;
            
            // Hazmat
            const hazmatHaul = document.getElementById('hazmatHaul').checked;
            doc.text(`Hauling hazardous materials or placarded loads?`, 15, yPosition);
            doc.text(`${hazmatHaul ? '‚òë' : '‚òê'} Yes ${hazmatHaul ? '‚òê' : '‚òë'} No`, 85, yPosition);
            if (hazmatHaul) {
                doc.text(`If yes, please list`, 115, yPosition);
                yPosition += 4;
                doc.text(`${formData.hazmatTypes || ''}`, 15, yPosition);
            }
            
            yPosition += 5;
            doc.text(`Routes of Travel (major cities)`, 15, yPosition);
            yPosition += 4;
            doc.text(`${formData.routesOfTravel || ''}`, 15, yPosition);
            
            yPosition += 8;
            
            // Gross receipts
            doc.text(`Gross Receipts: Current Year Est.`, 15, yPosition);
            doc.text(`${formData.grossReceipts || ''}`, 70, yPosition);
            doc.text(`Prior Year`, 110, yPosition);
            doc.text(`${formData.priorYearReceipts || ''}`, 130, yPosition);
            
            yPosition += 5;
            doc.text(`Subhaul Exposure? ‚òê Yes ‚òê No`, 15, yPosition);
            doc.text(`If yes, what is cost of hire`, 60, yPosition);
            
            yPosition += 10;
            
            // Coverages section header
            doc.setFont(undefined, 'bold');
            doc.text('Coverages:', 15, yPosition);
            doc.setFont(undefined, 'normal');
            yPosition += 8;
            
            // Coverage details in table format
            doc.text(`Liability Limit`, 15, yPosition);
            if (formData.selectedCoverages && formData.selectedCoverages.includes('autoLiability')) {
                const limit = formData.autoLiabilityLimit ? `${parseInt(formData.autoLiabilityLimit).toLocaleString()}` : '';
                doc.text(limit, 50, yPosition);
            }
            doc.text(`Liability Ded.`, 85, yPosition);
            doc.text(`Hired/NOA? ‚òê Yes ‚òê No`, 120, yPosition);
            
            yPosition += 5;
            doc.text(`UM`, 15, yPosition);
            doc.text(`$100,000`, 25, yPosition);
            doc.text(`Physical Damage Ded.`, 50, yPosition);
            if (formData.selectedCoverages && formData.selectedCoverages.includes('physicalDamage')) {
                const comp = formData.comprehensiveDeductible ? `${formData.comprehensiveDeductible}` : '';
                const coll = formData.collisionDeductible ? `${formData.collisionDeductible}` : '';
                doc.text(`${comp}/${coll}`, 85, yPosition);
            }
            doc.text(`(if any basis)`, 120, yPosition);
            
            yPosition += 5;
            doc.text(`Cargo Limit`, 15, yPosition);
            if (formData.selectedCoverages && formData.selectedCoverages.includes('cargoInsurance')) {
                const cargoLimit = formData.cargoLimit ? `${parseInt(formData.cargoLimit).toLocaleString()}` : '';
                doc.text(cargoLimit, 35, yPosition);
            }
            doc.text(`Cargo Ded.`, 70, yPosition);
            const cargoDed = formData.cargoDeductible ? `${formData.cargoDeductible}` : '';
            doc.text(cargoDed, 90, yPosition);
            
            const reeferBreakdown = formData.reeferBreakdown === 'yes';
            doc.text(`Reefer Breakdown? ${reeferBreakdown ? '‚òë' : '‚òê'} Yes ${reeferBreakdown ? '‚òê' : '‚òë'} No`, 115, yPosition);
            
            yPosition += 5;
            doc.text(`Average Cargo Limit`, 15, yPosition);
            doc.text(`Loading/Unloading? ‚òê Yes ‚òê No`, 115, yPosition);
            
            yPosition += 5;
            doc.text(`General Liability`, 15, yPosition);
            if (formData.selectedCoverages && formData.selectedCoverages.includes('generalLiability')) {
                doc.text(formData.generalLiabilityLimit || '1M/2M', 50, yPosition);
            }
            doc.text(`G.L. Ded.`, 85, yPosition);
            
            yPosition += 5;
            doc.text(`Other Coverages?`, 15, yPosition);
            
            yPosition += 10;
            
            // Previous Carriers & Loss History
            doc.setFont(undefined, 'bold');
            doc.text('Previous Carriers & Loss History:', 15, yPosition);
            doc.setFont(undefined, 'normal');
            yPosition += 8;
            
            // Loss history table header
            doc.text('Year', 15, yPosition);
            doc.text('Company', 35, yPosition);
            doc.text('Policy #', 75, yPosition);
            doc.text('# of claims', 105, yPosition);
            doc.text('Type', 130, yPosition);
            doc.text('$ Paid Out', 150, yPosition);
            yPosition += 5;
            
            // Current year data
            const currentYear = new Date().getFullYear();
            doc.text(`${currentYear}`, 15, yPosition);
            doc.text(`${formData.priorCarrier || ''}`, 35, yPosition);
            doc.text(`${formData.policyNumber || ''}`, 75, yPosition);
            doc.text(`${formData.claimsLast5Years || '0'}`, 105, yPosition);
            doc.text('Auto Lib', 130, yPosition);
            doc.text(`${formData.totalPaidOut || '$0'}`, 150, yPosition);
            
            yPosition += 15;
            
            // Vehicles section
            doc.setFont(undefined, 'bold');
            doc.text('Vehicles:', 15, yPosition);
            doc.setFont(undefined, 'normal');
            yPosition += 8;
            
            // Vehicle table header
            doc.setFontSize(8);
            doc.text('#', 15, yPosition);
            doc.text('Year', 25, yPosition);
            doc.text('Make', 40, yPosition);
            doc.text('Body Type', 60, yPosition);
            doc.text('GVW', 80, yPosition);
            doc.text('Serial #', 95, yPosition);
            doc.text('Ann. Miles', 130, yPosition);
            doc.text('Radius', 150, yPosition);
            doc.text('Value', 170, yPosition);
            yPosition += 5;
            
            // Vehicle data
            for (let i = 1; i <= vehicleCount; i++) {
                if (formData[`vehicle_${i}_year`]) {
                    doc.text(`${i}`, 15, yPosition);
                    doc.text(`${formData[`vehicle_${i}_year`] || ''}`, 25, yPosition);
                    doc.text(`${formData[`vehicle_${i}_make`] || ''}`, 40, yPosition);
                    doc.text(`${formData[`vehicle_${i}_body_type`] || ''}`, 60, yPosition);
                    const gvw = formData[`vehicle_${i}_gvw`];
                    doc.text(gvw === '80000' ? '80,000' : gvw || '', 80, yPosition);
                    
                    // Truncate VIN for display
                    const vin = formData[`vehicle_${i}_vin`] || '';
                    doc.text(vin.length > 10 ? vin.substring(0, 10) + '...' : vin, 95, yPosition);
                    
                    const miles = formData[`vehicle_${i}_annual_miles`];
                    doc.text(miles ? parseInt(miles).toLocaleString() : '', 130, yPosition);
                    doc.text(`${formData[`vehicle_${i}_radius`] || ''}`, 150, yPosition);
                    doc.text(`${formData[`vehicle_${i}_value`] || ''}`, 170, yPosition);
                    yPosition += 4;
                }
            }
