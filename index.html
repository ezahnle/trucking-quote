<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network TruckInsurance Services - Quote Application</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header .contact-info {
            font-size: 16px;
            opacity: 0.95;
            margin: 15px 0;
        }
        
        .header .subtitle {
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 20px;
            margin-top: 20px;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 6px;
            position: relative;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .section {
            border-bottom: 1px solid #e9ecef;
        }
        
        .section:last-of-type {
            border-bottom: none;
        }
        
        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-left: 5px solid #3498db;
            font-weight: 600;
            color: #2c3e50;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .section-status {
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 20px;
            background: #e9ecef;
            color: #6c757d;
        }
        
        .section-status.complete {
            background: #d4edda;
            color: #155724;
        }
        
        .section-status.partial {
            background: #fff3cd;
            color: #856404;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .form-group.half-width {
            grid-column: span 1;
        }
        
        label {
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        input.error, select.error, textarea.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }
        
        input.valid, select.valid, textarea.valid {
            border-color: #27ae60;
            background-color: #f8fff9;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 4px;
            display: none;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-item input[type="checkbox"] {
            transform: scale(1.3);
            margin: 0;
        }
        
        .notes {
            font-size: 12px;
            color: #6c757d;
            font-style: italic;
            margin-top: 4px;
        }
        
        .required {
            color: #e74c3c;
        }
        
        .entry-container {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            background: #fdfdfd;
            position: relative;
        }
        
        .entry-header {
            color: #3498db;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .btn-add {
            background: #27ae60;
            color: white;
            margin-top: 20px;
        }
        
        .btn-add:hover {
            background: #219a52;
            transform: translateY(-1px);
        }
        
        .btn-remove {
            background: #e74c3c;
            color: white;
            margin-top: 15px;
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 8px 16px;
            font-size: 12px;
        }
        
        .btn-remove:hover {
            background: #c0392b;
        }
        
        .coverage-grid {
            display: grid;
            gap: 20px;
        }
        
        .coverage-item {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            background: #fdfdfd;
            transition: all 0.2s ease;
        }
        
        .coverage-item.selected {
            border-color: #3498db;
            background: #f8fbff;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.1);
        }
        
        .coverage-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .coverage-header input[type="checkbox"] {
            transform: scale(1.4);
        }
        
        .coverage-title {
            font-weight: 600;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .coverage-details {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .percentage-tracker {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 6px;
            border: 2px solid #e9ecef;
            text-align: center;
            font-weight: 600;
            font-size: 16px;
        }
        
        .percentage-tracker.complete {
            background: #d4edda;
            border-color: #27ae60;
            color: #155724;
        }
        
        .percentage-tracker.over {
            background: #f8d7da;
            border-color: #e74c3c;
            color: #721c24;
        }
        
        .quote-summary {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .summary-header {
            color: #2c3e50;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .summary-label {
            font-weight: 600;
            color: #495057;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .summary-value {
            font-size: 16px;
            color: #2c3e50;
            margin-top: 5px;
        }
        
        .btn-save {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 30px;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        
        .btn-save:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loading-spinner {
            display: none;
            margin-left: 10px;
        }
        
        .validation-summary {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .validation-summary h4 {
            color: #721c24;
            margin-bottom: 10px;
        }
        
        .validation-summary ul {
            margin-left: 20px;
            color: #721c24;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 0;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .btn-remove {
                position: static;
                margin-top: 15px;
                width: 100%;
            }
        }
        
        @media print {
            .btn, button {
                display: none;
            }
            
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Network TruckInsurance Services, Inc.</h1>
            <div class="contact-info">
                <strong>Ed Zahnle - Licensed Agent/Broker</strong><br>
                Phone: (509) 215-3433 | Email: ed.zahnle@truckerinsurance.com
            </div>
            <div class="subtitle">
                <h2>Professional Insurance Quote Application</h2>
                <p>Complete Commercial Trucking Insurance Solutions</p>
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Validation Summary -->
        <div class="validation-summary" id="validationSummary">
            <h4>Please Complete Required Fields:</h4>
            <ul id="validationList"></ul>
        </div>
        
        <form id="quoteForm" action="https://formsubmit.co/ed.zahnle@truckerinsurance.com" method="POST" novalidate>
            <!-- Formsubmit configuration -->
            <input type="hidden" name="_subject" id="emailSubject" value="New Trucking Insurance Quote">
            <input type="hidden" name="_template" value="table">
            <input type="hidden" name="_next" value="https://yourdomain.com/thank-you.html">
            <input type="hidden" name="_autoresponse" value="Thank you for your trucking insurance quote submission with Network TruckInsurance Services. Ed Zahnle will review your information and contact you within 24 hours. To complete your quote package, please prepare: 1) Loss Runs from your current/prior insurance carrier (last 5 years), 2) IFTA reports (last 4 quarters). We will handle ordering Motor Vehicle Records directly. Need help obtaining your loss runs? We can create the request documents and send them to you via Adobe Sign for electronic signature - just let us know!">
            
            <!-- Hidden fields for tracking -->
            <input type="hidden" name="quote_id" id="hiddenQuoteId" value="">
            <input type="hidden" name="submission_date" id="hiddenSubmissionDate" value="">
            <input type="hidden" name="agent_notes" id="hiddenAgentNotes" value="">
            <input type="hidden" name="documents_needed" value="Loss runs from current carrier, IFTA reports (last 4 quarters) - MVRs will be ordered by agency. Offer loss run document assistance via Adobe Sign.">
            <input type="hidden" name="status" value="Quote Received - Pending Loss Runs/IFTAS">
            
            <!-- Section 1: Business Information -->
            <div class="section">
                <div class="section-header">
                    <span>1. Business Information</span>
                    <span class="section-status" id="section1Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="businessName">Business Name <span class="required">*</span></label>
                            <input type="text" id="businessName" name="businessName" required 
                                   placeholder="Legal name of insured">
                            <div class="error-message">Business name is required</div>
                            <div class="notes">Legal business name as registered</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="contactName">Contact Name <span class="required">*</span></label>
                            <input type="text" id="contactName" name="contactName" required 
                                   placeholder="Primary contact person">
                            <div class="error-message">Contact name is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number <span class="required">*</span></label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" required 
                                   placeholder="(555) 123-4567">
                            <div class="error-message">Valid phone number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="emailAddress">Email Address <span class="required">*</span></label>
                            <input type="email" id="emailAddress" name="emailAddress" required 
                                   placeholder="contact@company.com">
                            <div class="error-message">Valid email address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="businessAddress">Business Address <span class="required">*</span></label>
                            <input type="text" id="businessAddress" name="businessAddress" required 
                                   placeholder="Street Address" style="margin-bottom: 10px;">
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                <input type="text" id="businessCity" name="businessCity" required placeholder="City">
                                <input type="text" id="businessState" name="businessState" required placeholder="State">
                                <input type="text" id="businessZip" name="businessZip" required placeholder="ZIP Code">
                            </div>
                            <div class="error-message">Complete address is required</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <div class="checkbox-group" style="margin-bottom: 15px;">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="sameAsBusinessAddress" onchange="toggleGarageAddress()">
                                    <label for="sameAsBusinessAddress">Garage address same as business address</label>
                                </div>
                            </div>
                            <div id="garageAddressSection">
                                <label for="garageAddress">Garage Address <span class="required">*</span></label>
                                <input type="text" id="garageAddress" name="garageAddress" required 
                                       placeholder="Street Address" style="margin-bottom: 10px;">
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                                    <input type="text" id="garageCity" name="garageCity" required placeholder="City">
                                    <input type="text" id="garageState" name="garageState" required placeholder="State">
                                    <input type="text" id="garageZip" name="garageZip" required placeholder="ZIP Code">
                                </div>
                                <div class="error-message">Garage address is required</div>
                                <div class="notes">Where vehicles are parked overnight</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="usdotNumber">USDOT Number <span class="required">*</span></label>
                            <input type="text" id="usdotNumber" name="usdotNumber" required 
                                   placeholder="1234567">
                            <div class="error-message">USDOT number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="mcNumber">MC Number <span class="required">*</span></label>
                            <input type="text" id="mcNumber" name="mcNumber" required 
                                   placeholder="MC-123456">
                            <div class="error-message">MC number is required</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="agencyId">Agency ID <span class="required">*</span></label>
                            <input type="text" id="agencyId" name="agencyId" required 
                                   placeholder="NTI-2024-001">
                            <div class="error-message">Agency ID is required</div>
                            <div class="notes">Internal agency tracking identifier</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="feinNumber">Federal EIN</label>
                            <input type="text" id="feinNumber" name="feinNumber" 
                                   placeholder="12-3456789">
                            <div class="notes">Federal Employer Identification Number</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="yearsInBusiness">Years in Business <span class="required">*</span></label>
                            <select id="yearsInBusiness" name="yearsInBusiness" required>
                                <option value="">Select years in business...</option>
                                <option value="<1">Less than 1 year</option>
                                <option value="1-3">1-3 years</option>
                                <option value="4-7">4-7 years</option>
                                <option value="8+">8+ years</option>
                            </select>
                            <div class="error-message">Years in business is required</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 2: Driver Information -->
            <div class="section">
                <div class="section-header">
                    <span>2. Driver Information</span>
                    <span class="section-status" id="section2Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="driversContainer">
                        <!-- Driver entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addDriver()">+ Add Driver</button>
                </div>
            </div>
            
            <!-- Section 3: Vehicle Information -->
            <div class="section">
                <div class="section-header">
                    <span>3. Vehicle & Equipment Details</span>
                    <span class="section-status" id="section3Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="vehiclesContainer">
                        <!-- Vehicle entries will be added here -->
                    </div>
                    <button type="button" class="btn btn-add" onclick="addVehicle()">+ Add Vehicle</button>
                </div>
            </div>
            
            <!-- Section 4: Coverage Requirements -->
            <div class="section">
                <div class="section-header">
                    <span>4. Insurance Coverage Requirements</span>
                    <span class="section-status" id="section4Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div class="coverage-grid">
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="autoLiability" name="coverages" value="autoLiability" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="autoLiability">Primary Auto Liability</label>
                            </div>
                            <div class="notes">Required for commercial vehicle operation</div>
                            <div class="coverage-details" id="autoLiabilityDetails">
                                <div class="form-group">
                                    <label for="autoLiabilityLimit">Coverage Limit <span class="required">*</span></label>
                                    <select id="autoLiabilityLimit" name="autoLiabilityLimit">
                                        <option value="">Select limit...</option>
                                        <option value="750000">$750,000</option>
                                        <option value="1000000">$1,000,000</option>
                                        <option value="2000000">$2,000,000</option>
                                        <option value="5000000">$5,000,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="physicalDamage" name="coverages" value="physicalDamage" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="physicalDamage">Physical Damage</label>
                            </div>
                            <div class="notes">Comprehensive and collision coverage</div>
                            <div class="coverage-details" id="physicalDamageDetails">
                                <div class="form-group">
                                    <label for="comprehensiveDeductible">Comprehensive Deductible</label>
                                    <select id="comprehensiveDeductible" name="comprehensiveDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="500">$500</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="collisionDeductible">Collision Deductible</label>
                                    <select id="collisionDeductible" name="collisionDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                        <option value="10000">$10,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="cargoInsurance" name="coverages" value="cargoInsurance" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="cargoInsurance">Cargo Insurance</label>
                            </div>
                            <div class="notes">Coverage for transported goods</div>
                            <div class="coverage-details" id="cargoInsuranceDetails">
                                <div class="form-group">
                                    <label for="cargoLimit">Coverage Limit</label>
                                    <select id="cargoLimit" name="cargoLimit">
                                        <option value="">Select limit...</option>
                                        <option value="100000">$100,000</option>
                                        <option value="250000">$250,000</option>
                                        <option value="500000">$500,000</option>
                                        <option value="1000000">$1,000,000</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="cargoDeductible">Deductible</label>
                                    <select id="cargoDeductible" name="cargoDeductible">
                                        <option value="">Select deductible...</option>
                                        <option value="1000">$1,000</option>
                                        <option value="2500">$2,500</option>
                                        <option value="5000">$5,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coverage-item">
                            <div class="coverage-header">
                                <input type="checkbox" id="generalLiability" name="coverages" value="generalLiability" onchange="toggleCoverageDetails(this)">
                                <label class="coverage-title" for="generalLiability">General Liability</label>
                            </div>
                            <div class="notes">Non-auto liability coverage</div>
                            <div class="coverage-details" id="generalLiabilityDetails">
                                <div class="form-group">
                                    <label for="generalLiabilityLimit">Coverage Limit</label>
                                    <select id="generalLiabilityLimit" name="generalLiabilityLimit">
                                        <option value="">Select limit...</option>
                                        <option value="1000000">$1,000,000</option>
                                        <option value="2000000">$2,000,000</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section 5: Commodity Information -->
            <div class="section">
                <div class="section-header">
                    <span>5. Commodity & Cargo Information</span>
                    <span class="section-status" id="section5Status">Incomplete</span>
                </div>
                <div class="section-content">
                    <div id="commoditiesContainer">
                        <!-- Commodity entries will be added here -->
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                        <button type="button" class="btn btn-add" onclick="addCommodity()">+ Add Commodity</button>
                        <div class="percentage-tracker" id="percentageTracker">Total: 0%</div>
                    </div>
                </div>
            </div>
            
            <!-- Section 6: Loss History -->
            <div class="section">
                <div class="section-header">
                    <span>6. Loss History & Claims</span>
                    <span class="section-status" id="section6Status">Complete</span>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="priorCarrier">Current/Prior Insurance Carrier</label>
                            <input type="text" id="priorCarrier" name="priorCarrier" 
                                   placeholder="Insurance company name">
                        </div>
                        
                        <div class="form-group">
                            <label for="claimsLast5Years">Claims in Last 5 Years</label>
                            <select id="claimsLast5Years" name="claimsLast5Years">
                                <option value="0">No claims</option>
                                <option value="1">1 claim</option>
                                <option value="2">2 claims</option>
                                <option value="3">3 claims</option>
                                <option value="4+">4 or more claims</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="claimsDescription">Claims Description (if applicable)</label>
                            <textarea id="claimsDescription" name="claimsDescription" rows="3" 
                                      placeholder="Brief description of any claims..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quote Summary Section -->
            <div class="quote-summary">
                <div class="summary-header">Quote Summary</div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Quote ID (USDOT)</div>
                        <div class="summary-value" id="quoteId">Enter USDOT number</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Date Created</div>
                        <div class="summary-value" id="quoteDate">Loading...</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Agency Number</div>
                        <div class="summary-value" id="summaryAgencyId">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Business Name</div>
                        <div class="summary-value" id="summaryBusinessName">Not entered</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Vehicles</div>
                        <div class="summary-value" id="summaryVehicleCount">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Drivers</div>
                        <div class="summary-value" id="summaryDriverCount">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Coverage Types</div>
                        <div class="summary-value" id="summaryCoverageCount">0 selected</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Submission Status</div>
                        <div class="summary-value" id="submissionStatus">Ready to Submit</div>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Submit Button -->
        <div style="text-align: center; padding: 30px;">
            <button type="button" class="btn-save" id="submitBtn" onclick="submitQuote()">
                Submit Quote for Review
                <span class="loading-spinner" id="loadingSpinner">⟳</span>
            </button>
        </div>
    </div>
    
    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Global counters
        let driverCount = 0;
        let vehicleCount = 0;
        let commodityCount = 0;
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeQuote();
            addDriver(); // Add first driver
            addVehicle(); // Add first vehicle
            addCommodity(); // Add first commodity
            setupEventListeners();
        });
        
        function initializeQuote() {
            // Initialize with placeholder until USDOT is entered
            const today = new Date();
            const dateString = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById('quoteId').textContent = 'Enter USDOT number';
            document.getElementById('quoteDate').textContent = dateString;
        }
        
        function updateQuoteId() {
            const usdotNumber = document.getElementById('usdotNumber').value;
            const quoteId = usdotNumber ? `DOT-${usdotNumber}` : 'Enter USDOT number';
            document.getElementById('quoteId').textContent = quoteId;
            return quoteId;
        }
        
        function setupEventListeners() {
            // Add form validation listeners
            const form = document.getElementById('quoteForm');
            const inputs = form.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                input.addEventListener('input', validateField);
                input.addEventListener('blur', validateField);
                input.addEventListener('change', updateProgress);
            });
            
            // Update summary on business name change
            document.getElementById('businessName').addEventListener('input', function() {
                document.getElementById('summaryBusinessName').textContent = this.value || 'Not entered';
            });
            
            // Update quote ID when USDOT number changes
            document.getElementById('usdotNumber').addEventListener('input', function() {
                updateQuoteId();
            });
            
            // Update agency ID in summary
            document.getElementById('agencyId').addEventListener('input', function() {
                document.getElementById('summaryAgencyId').textContent = this.value || 'Not entered';
            });
        }
        
        function validateField(event) {
            const field = event.target;
            const value = field.value.trim();
            const isRequired = field.hasAttribute('required');
            
            // Clear previous validation state
            field.classList.remove('error', 'valid');
            const errorMsg = field.parentNode.querySelector('.error-message');
            if (errorMsg) {
                errorMsg.style.display = 'none';
            }
            
            if (isRequired && !value) {
                field.classList.add('error');
                if (errorMsg) {
                    errorMsg.style.display = 'block';
                }
                return false;
            }
            
            // Field-specific validation
            if (field.type === 'email' && value) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(value)) {
                    field.classList.add('error');
                    if (errorMsg) {
                        errorMsg.textContent = 'Please enter a valid email address';
                        errorMsg.style.display = 'block';
                    }
                    return false;
                }
            }
            
            if (field.type === 'tel' && value) {
                const phoneRegex = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
                if (!phoneRegex.test(value)) {
                    field.classList.add('error');
                    if (errorMsg) {
                        errorMsg.textContent = 'Please enter a valid phone number';
                        errorMsg.style.display = 'block';
                    }
                    return false;
                }
            }
            
            if (value) {
                field.classList.add('valid');
            }
            
            return true;
        }
        
        function updateProgress() {
            const form = document.getElementById('quoteForm');
            const requiredFields = form.querySelectorAll('[required]');
            const completedFields = Array.from(requiredFields).filter(field => field.value.trim() !== '');
            
            const progressPercent = (completedFields.length / requiredFields.length) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            
            // Update section statuses
            updateSectionStatus('section1Status', checkSectionComplete(1));
            updateSectionStatus('section2Status', checkSectionComplete(2));
            updateSectionStatus('section3Status', checkSectionComplete(3));
            updateSectionStatus('section4Status', checkSectionComplete(4));
            updateSectionStatus('section5Status', checkSectionComplete(5));
            
            // Update summary counts
            updateSummaryCounts();
        }
        
        function checkSectionComplete(sectionNumber) {
            const section = document.querySelector(`.section:nth-child(${sectionNumber + 1})`);
            const requiredFields = section?.querySelectorAll('[required]') || [];
            const completedFields = Array.from(requiredFields).filter(field => field.value.trim() !== '');
            
            if (requiredFields.length === 0) return 'complete';
            if (completedFields.length === 0) return 'incomplete';
            if (completedFields.length === requiredFields.length) return 'complete';
            return 'partial';
        }
        
        function updateSectionStatus(elementId, status) {
            const element = document.getElementById(elementId);
            element.textContent = status.charAt(0).toUpperCase() + status.slice(1);
            element.className = 'section-status ' + status;
        }
        
        function updateSummaryCounts() {
            const driverEntries = document.querySelectorAll('#driversContainer .entry-container');
            const vehicleEntries = document.querySelectorAll('#vehiclesContainer .entry-container');
            const selectedCoverages = document.querySelectorAll('input[name="coverages"]:checked');
            
            document.getElementById('summaryDriverCount').textContent = driverEntries.length;
            document.getElementById('summaryVehicleCount').textContent = vehicleEntries.length;
            document.getElementById('summaryCoverageCount').textContent = selectedCoverages.length + ' selected';
        }
        
        function toggleGarageAddress() {
            const checkbox = document.getElementById('sameAsBusinessAddress');
            const garageSection = document.getElementById('garageAddressSection');
            const garageFields = garageSection.querySelectorAll('input');
            
            if (checkbox.checked) {
                garageSection.style.display = 'none';
                
                // Copy business address to garage fields
                document.getElementById('garageAddress').value = document.getElementById('businessAddress').value;
                document.getElementById('garageCity').value = document.getElementById('businessCity').value;
                document.getElementById('garageState').value = document.getElementById('businessState').value;
                document.getElementById('garageZip').value = document.getElementById('businessZip').value;
                
                // Remove required attribute
                garageFields.forEach(field => field.removeAttribute('required'));
            } else {
                garageSection.style.display = 'block';
                
                // Add required attribute back
                garageFields.forEach(field => field.setAttribute('required', 'required'));
                
                // Clear garage fields
                garageFields.forEach(field => field.value = '');
            }
        }
        
        function addDriver() {
            driverCount++;
            const container = document.getElementById('driversContainer');
            
            const driverHtml = `
                <div class="entry-container" data-driver="${driverCount}">
                    ${driverCount > 1 ? `<button type="button" class="btn-remove" onclick="removeDriver(${driverCount})">Remove</button>` : ''}
                    <div class="entry-header">Driver #${driverCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Driver Name <span class="required">*</span></label>
                            <input type="text" name="driver_${driverCount}_name" required placeholder="Full legal name">
                            <div class="error-message">Driver name is required</div>
                        </div>
                        <div class="form-group">
                            <label>Date of Birth <span class="required">*</span></label>
                            <input type="date" name="driver_${driverCount}_dob" required>
                            <div class="error-message">Date of birth is required</div>
                        </div>
                        <div class="form-group">
                            <label>License State & Number <span class="required">*</span></label>
                            <input type="text" name="driver_${driverCount}_license" required placeholder="CA D1234567">
                            <div class="error-message">License information is required</div>
                        </div>
                        <div class="form-group">
                            <label>Years of Experience <span class="required">*</span></label>
                            <select name="driver_${driverCount}_experience" required>
                                <option value="">Select experience...</option>
                                <option value="<1">Less than 1 year</option>
                                <option value="1-3">1-3 years</option>
                                <option value="4-7">4-7 years</option>
                                <option value="8+">8+ years</option>
                            </select>
                            <div class="error-message">Experience level is required</div>
                        </div>
                        <div class="form-group full-width">
                            <label>Violations/Accidents (Last 3 Years)</label>
                            <textarea name="driver_${driverCount}_violations" rows="2" 
                                      placeholder="List any violations, accidents, or claims..."></textarea>
                            <div class="notes">Include dates and brief descriptions</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', driverHtml);
            
            // Add event listeners to new fields
            const newDriverContainer = container.lastElementChild;
            const newFields = newDriverContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
        }
        
        function removeDriver(driverNumber) {
            const driverElement = document.querySelector(`[data-driver="${driverNumber}"]`);
            if (driverElement) {
                driverElement.remove();
                updateProgress();
            }
        }
        
        function addVehicle() {
            vehicleCount++;
            const container = document.getElementById('vehiclesContainer');
            
            const vehicleHtml = `
                <div class="entry-container" data-vehicle="${vehicleCount}">
                    ${vehicleCount > 1 ? `<button type="button" class="btn-remove" onclick="removeVehicle(${vehicleCount})">Remove</button>` : ''}
                    <div class="entry-header">Vehicle #${vehicleCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Year/Make/Model <span class="required">*</span></label>
                            <input type="text" name="vehicle_${vehicleCount}_make_model" required 
                                   placeholder="2020 Freightliner Cascadia">
                            <div class="error-message">Vehicle make/model is required</div>
                        </div>
                        <div class="form-group">
                            <label>VIN <span class="required">*</span></label>
                            <input type="text" name="vehicle_${vehicleCount}_vin" required 
                                   placeholder="17-digit VIN number">
                            <div class="error-message">VIN is required</div>
                        </div>
                        <div class="form-group">
                            <label>Vehicle Value <span class="required">*</span></label>
                            <input type="text" name="vehicle_${vehicleCount}_value" required 
                                   placeholder="$85,000">
                            <div class="error-message">Vehicle value is required</div>
                            <div class="notes">Current market/replacement value</div>
                        </div>
                        <div class="form-group">
                            <label>GVW Rating <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_gvw" required>
                                <option value="">Select GVW...</option>
                                <option value=">80000">Over 80,000 lbs</option>
                                <option value="60001-80000">60,001-80,000 lbs</option>
                                <option value="40001-60000">40,001-60,000 lbs</option>
                                <option value="26001-40000">26,001-40,000 lbs</option>
                            </select>
                            <div class="error-message">GVW rating is required</div>
                        </div>
                        <div class="form-group">
                            <label>Operating Radius <span class="required">*</span></label>
                            <select name="vehicle_${vehicleCount}_radius" required>
                                <option value="">Select radius...</option>
                                <option value="0-100">0-100 miles</option>
                                <option value="101-300">101-300 miles</option>
                                <option value="301-500">301-500 miles</option>
                                <option value="500+">500+ miles</option>
                            </select>
                            <div class="error-message">Operating radius is required</div>
                        </div>
                        <div class="form-group">
                            <label>ELD Provider</label>
                            <select name="vehicle_${vehicleCount}_eld">
                                <option value="">Select ELD provider...</option>
                                <option value="KeepTruckin">KeepTruckin</option>
                                <option value="Samsara">Samsara</option>
                                <option value="Omnitracs">Omnitracs</option>
                                <option value="PeopleNet">PeopleNet</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', vehicleHtml);
            
            // Add event listeners to new fields
            const newVehicleContainer = container.lastElementChild;
            const newFields = newVehicleContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
        }
        
        function removeVehicle(vehicleNumber) {
            const vehicleElement = document.querySelector(`[data-vehicle="${vehicleNumber}"]`);
            if (vehicleElement) {
                vehicleElement.remove();
                updateProgress();
            }
        }
        
        function addCommodity() {
            commodityCount++;
            const container = document.getElementById('commoditiesContainer');
            
            const commodityHtml = `
                <div class="entry-container" data-commodity="${commodityCount}">
                    ${commodityCount > 1 ? `<button type="button" class="btn-remove" onclick="removeCommodity(${commodityCount})">Remove</button>` : ''}
                    <div class="entry-header">Commodity #${commodityCount}</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Commodity Type <span class="required">*</span></label>
                            <select name="commodity_${commodityCount}_type" required>
                                <option value="">Select commodity...</option>
                                <option value="General Freight">General Freight</option>
                                <option value="Refrigerated">Refrigerated</option>
                                <option value="Flatbed">Flatbed</option>
                                <option value="Dry Van">Dry Van</option>
                                <option value="Tanker">Tanker</option>
                                <option value="Auto Hauler">Auto Hauler</option>
                                <option value="Heavy Haul">Heavy Haul</option>
                                <option value="Container">Container</option>
                                <option value="Hazmat">Hazmat</option>
                                <option value="Dump Truck">Dump Truck</option>
                                <option value="Box Truck">Box Truck</option>
                                <option value="Intermodal">Intermodal</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="error-message">Commodity type is required</div>
                        </div>
                        <div class="form-group">
                            <label>Percentage of Loads <span class="required">*</span></label>
                            <input type="number" name="commodity_${commodityCount}_percentage" required 
                                   min="1" max="100" placeholder="50" onchange="updatePercentageTotal()">
                            <div class="error-message">Percentage is required</div>
                            <div class="notes">% of total annual loads</div>
                        </div>
                        <div class="form-group">
                            <label>Average Load Value</label>
                            <input type="text" name="commodity_${commodityCount}_avg_value" 
                                   placeholder="$25,000">
                            <div class="notes">Typical cargo value per load</div>
                        </div>
                        <div class="form-group">
                            <label>Maximum Load Value</label>
                            <input type="text" name="commodity_${commodityCount}_max_value" 
                                   placeholder="$50,000">
                            <div class="notes">Highest value load transported</div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', commodityHtml);
            
            // Add event listeners to new fields
            const newCommodityContainer = container.lastElementChild;
            const newFields = newCommodityContainer.querySelectorAll('input, select, textarea');
            newFields.forEach(field => {
                field.addEventListener('input', validateField);
                field.addEventListener('blur', validateField);
                field.addEventListener('change', updateProgress);
            });
            
            updateProgress();
            updatePercentageTotal();
        }
        
        function removeCommodity(commodityNumber) {
            const commodityElement = document.querySelector(`[data-commodity="${commodityNumber}"]`);
            if (commodityElement) {
                commodityElement.remove();
                updatePercentageTotal();
                updateProgress();
            }
        }
        
        function updatePercentageTotal() {
            const percentageInputs = document.querySelectorAll('input[name*="commodity_"][name*="_percentage"]');
            let total = 0;
            
            percentageInputs.forEach(input => {
                total += parseInt(input.value) || 0;
            });
            
            const tracker = document.getElementById('percentageTracker');
            tracker.textContent = `Total: ${total}%`;
            
            // Update styling
            tracker.className = 'percentage-tracker';
            if (total === 100) {
                tracker.classList.add('complete');
            } else if (total > 100) {
                tracker.classList.add('over');
            }
        }
        
        function toggleCoverageDetails(checkbox) {
            const coverageItem = checkbox.closest('.coverage-item');
            const details = coverageItem.querySelector('.coverage-details');
            
            if (checkbox.checked) {
                details.style.display = 'grid';
                coverageItem.classList.add('selected');
            } else {
                details.style.display = 'none';
                coverageItem.classList.remove('selected');
                
                // Clear values in hidden details
                const inputs = details.querySelectorAll('input, select');
                inputs.forEach(input => input.value = '');
            }
            
            updateProgress();
        }
        
        function validateForm() {
            const form = document.getElementById('quoteForm');
            const requiredFields = form.querySelectorAll('[required]');
            const errors = [];
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    errors.push(field.previousElementSibling.textContent.replace(' *', ''));
                    field.classList.add('error');
                } else {
                    field.classList.remove('error');
                }
            });
            
            // Check commodity percentages
            const percentageInputs = document.querySelectorAll('input[name*="commodity_"][name*="_percentage"]');
            let total = 0;
            percentageInputs.forEach(input => total += parseInt(input.value) || 0);
            
            if (total !== 100 && percentageInputs.length > 0) {
                errors.push('Commodity percentages must total 100%');
            }
            
            // Check if at least one coverage is selected
            const selectedCoverages = document.querySelectorAll('input[name="coverages"]:checked');
            if (selectedCoverages.length === 0) {
                errors.push('At least one insurance coverage must be selected');
            }
            
            // Display validation summary
            const validationSummary = document.getElementById('validationSummary');
            const validationList = document.getElementById('validationList');
            
            if (errors.length > 0) {
                validationList.innerHTML = errors.map(error => `<li>${error}</li>`).join('');
                validationSummary.style.display = 'block';
                validationSummary.scrollIntoView({ behavior: 'smooth', block: 'start' });
                return false;
            } else {
                validationSummary.style.display = 'none';
                return true;
            }
        }
        
        function collectFormData() {
            const form = document.getElementById('quoteForm');
            const formData = new FormData(form);
            const data = {};
            
            // Convert FormData to object
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Use USDOT number as quote ID
            const usdotNumber = document.getElementById('usdotNumber').value;
            data.quoteId = usdotNumber ? `DOT-${usdotNumber}` : 'NO-USDOT';
            data.submissionDate = new Date().toISOString();
            data.driverCount = document.querySelectorAll('#driversContainer .entry-container').length;
            data.vehicleCount = document.querySelectorAll('#vehiclesContainer .entry-container').length;
            data.commodityCount = document.querySelectorAll('#commoditiesContainer .entry-container').length;
            
            // Collect selected coverages
            const selectedCoverages = Array.from(document.querySelectorAll('input[name="coverages"]:checked'))
                .map(checkbox => checkbox.value);
            data.selectedCoverages = selectedCoverages;
            
            return data;
        }
        
        function generatePDF(formData) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add header
            doc.setFontSize(20);
            doc.setTextColor(44, 62, 80);
            doc.text('Network TruckInsurance Services, Inc.', 20, 30);
            
            doc.setFontSize(12);
            doc.text('Commercial Trucking Insurance Quote', 20, 40);
            doc.text(`Quote ID: ${formData.quoteId}`, 20, 50);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 60);
            doc.text(`Agency ID: ${formData.agencyId || 'Not specified'}`, 20, 70);
            
            // Add business information
            doc.setFontSize(14);
            doc.setTextColor(52, 152, 219);
            doc.text('Business Information', 20, 90);
            
            doc.setFontSize(11);
            doc.setTextColor(0, 0, 0);
            let yPos = 100;
            
            if (formData.businessName) {
                doc.text(`Business Name: ${formData.businessName}`, 20, yPos);
                yPos += 10;
            }
            
            if (formData.contactName) {
                doc.text(`Contact: ${formData.contactName}`, 20, yPos);
                yPos += 10;
            }
            
            if (formData.phoneNumber) {
                doc.text(`Phone: ${formData.phoneNumber}`, 20, yPos);
                yPos += 10;
            }
            
            if (formData.emailAddress) {
                doc.text(`Email: ${formData.emailAddress}`, 20, yPos);
                yPos += 10;
            }
            
            if (formData.usdotNumber) {
                doc.text(`USDOT: ${formData.usdotNumber}`, 20, yPos);
                yPos += 10;
            }
            
            if (formData.mcNumber) {
                doc.text(`MC Number: ${formData.mcNumber}`, 20, yPos);
                yPos += 10;
            }
            
            // Add coverage information
            yPos += 10;
            doc.setFontSize(14);
            doc.setTextColor(52, 152, 219);
            doc.text('Requested Coverage', 20, yPos);
            yPos += 10;
            
            doc.setFontSize(11);
            doc.setTextColor(0, 0, 0);
            
            if (formData.selectedCoverages && formData.selectedCoverages.length > 0) {
                formData.selectedCoverages.forEach(coverage => {
                    doc.text(`• ${coverage.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}`, 25, yPos);
                    yPos += 8;
                });
            }
            
            // Add fleet summary
            yPos += 10;
            doc.setFontSize(14);
            doc.setTextColor(52, 152, 219);
            doc.text('Fleet Summary', 20, yPos);
            yPos += 10;
            
            doc.setFontSize(11);
            doc.setTextColor(0, 0, 0);
            doc.text(`Drivers: ${formData.driverCount}`, 20, yPos);
            yPos += 8;
            doc.text(`Vehicles: ${formData.vehicleCount}`, 20, yPos);
            yPos += 8;
            
            // Add footer
            doc.setFontSize(10);
            doc.setTextColor(108, 117, 125);
            doc.text('This quote is preliminary and subject to underwriting approval.', 20, 280);
            doc.text('Contact: Ed Zahnle | (509) 215-3433 | ed.zahnle@truckerinsurance.com', 20, 290);
            
            return doc;
        }
        
        // Function to submit data to Google Sheets
        async function submitToGoogleSheets(formData) {
            const sheetData = {
                date: new Date().toLocaleDateString(),
                quoteId: formData.quoteId,
                customerName: formData.businessName,
                contactName: formData.contactName,
                phone: formData.phoneNumber,
                email: formData.emailAddress,
                state: formData.businessState,
                agencyId: formData.agencyId,
                operationType: getOperationType(formData),
                commodity: getCommodityType(formData),
                fleetTrucks: formData.driverCount,
                fleetTrailers: '0',
                radius: getRadius(formData),
                yearsInBusiness: formData.yearsInBusiness,
                currentCarrier: formData.priorCarrier || 'Not specified',
                mvrsOrdered: 'Pending',
                lossRunsStatus: 'Pending',
                iftaStatus: 'Pending',
                documentsComplete: 'No',
                status: 'Quote Received - Pending Docs',
                finalNotes: 'Initial quote submission via form'
            };
            
            try {
                // Submit to Google Apps Script Web App
                const response = await fetch('https://script.google.com/macros/s/AKfycbwrt3Axv4G0zLkp27T4Pf9uXPh1JkH2isMudio8G2t3Zd1Sj9FF4ow8ULgJw0YXDg/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(sheetData)
                });
                
                console.log('Successfully submitted to Google Sheets');
            } catch (error) {
                console.error('Failed to submit to Google Sheets:', error);
                // Don't throw error - let the form submission continue
            }
        }
        
        function getOperationType(formData) {
            // Extract operation type from vehicle radius data
            const radiusSelects = document.querySelectorAll('select[name*="vehicle_"][name*="_radius"]');
            for (let select of radiusSelects) {
                if (select.value) {
                    if (select.value.includes('0-100') || select.value.includes('101-300')) {
                        return 'Local';
                    } else if (select.value.includes('301-500')) {
                        return 'Regional';
                    } else if (select.value.includes('500+')) {
                        return 'Long Haul';
                    }
                }
            }
            return 'Local'; // Default
        }
        
        function getCommodityType(formData) {
            // Get first commodity type
            const commoditySelect = document.querySelector('select[name*="commodity_1_type"]');
            return commoditySelect ? commoditySelect.value : 'General Freight';
        }
        
        function getRadius(formData) {
            // Get first vehicle radius
            const radiusSelect = document.querySelector('select[name*="vehicle_1_radius"]');
            return radiusSelect ? radiusSelect.value : 'Not specified';
        }
        
        async function submitQuote() {
            const submitBtn = document.getElementById('submitBtn');
            const spinner = document.getElementById('loadingSpinner');
            
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            // Show loading state
            submitBtn.disabled = true;
            spinner.style.display = 'inline';
            submitBtn.textContent = 'Generating Quote & Sending...';
            
            try {
                // Collect form data
                const formData = collectFormData();
                
                // Update hidden fields for Formsubmit
                const quoteId = updateQuoteId();
                document.getElementById('hiddenQuoteId').value = quoteId;
                document.getElementById('hiddenSubmissionDate').value = new Date().toISOString();
                document.getElementById('emailSubject').value = `New Trucking Quote: ${quoteId} - ${formData.businessName}`;
                
                // Generate PDF locally first
                const pdf = generatePDF(formData);
                const pdfBlob = pdf.output('blob');
                
                // Download PDF for your records using USDOT as filename
                const url = URL.createObjectURL(pdfBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${quoteId}_${formData.businessName.replace(/[^a-zA-Z0-9]/g, '_')}.pdf`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                // Submit to Google Sheets
                await submitToGoogleSheets(formData);
                
                // Add agent notes section for your use
                const agentNotes = prompt(`Quote ${quoteId} PDF downloaded & saved to tracking sheet!

Add any phone call notes for this quote:
(Optional - these will be included in the email)`);
                
                if (agentNotes) {
                    document.getElementById('hiddenAgentNotes').value = agentNotes;
                }
                
                // Submit the form to Formsubmit
                submitBtn.textContent = 'Submitting to Email...';
                document.getElementById('quoteForm').submit();
                
            } catch (error) {
                console.error('Error during submission:', error);
                
                // Fallback - still try to submit form
                alert('There was an issue with the tracking system, but submitting quote data via email...');
                document.getElementById('quoteForm').submit();
            }
        }
        
        // Add agent workflow helpers
        function quickFillDemo() {
            // Helper function for testing/demo purposes
            document.getElementById('businessName').value = 'ABC Trucking Company';
            document.getElementById('contactName').value = 'John Smith';
            document.getElementById('phoneNumber').value = '(555) 123-4567';
            document.getElementById('emailAddress').value = 'john@abctrucking.com';
            document.getElementById('businessAddress').value = '123 Truck Lane';
            document.getElementById('businessCity').value = 'Los Angeles';
            document.getElementById('businessState').value = 'CA';
            document.getElementById('businessZip').value = '90210';
            document.getElementById('usdotNumber').value = '1234567';
            document.getElementById('mcNumber').value = 'MC-123456';
            document.getElementById('agencyId').value = 'NTI-2024-001';
            document.getElementById('yearsInBusiness').value = '4-7';
            
            // Check same address
            document.getElementById('sameAsBusinessAddress').checked = true;
            toggleGarageAddress();
            
            updateProgress();
        }
        
        // Add keyboard shortcuts for agent efficiency
        document.addEventListener('keydown', function(event) {
            // Ctrl+Enter to quick submit
            if (event.ctrlKey && event.key === 'Enter') {
                event.preventDefault();
                submitQuote();
            }
            
            // Ctrl+D for demo fill (testing)
            if (event.ctrlKey && event.key === 'd') {
                event.preventDefault();
                if (confirm('Fill form with demo data for testing?')) {
                    quickFillDemo();
                }
            }
        });
        
        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', updateProgress);
    </script>
</body>
</html>
